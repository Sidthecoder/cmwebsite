function trf(t,e){t.style.webkitTransform=t.style.OTransform=t.style.msTransform=t.style.MozTransform=t.style.transform=e}function trfo(t,e){t.style.webkitTransformOrigin=t.style.OTransformOrigin=t.style.msTransformOrigin=t.style.MozTransformOrigin=t.style.transformOrigin=e}function addCss(t){var e=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(e),e.type="text/css",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function mkBtn(t,e,s,a){var l=document.createElement("div");t.tagName||(t=document.getElementById(t),t.style.width=s+"px",t.style.height=a+"px",l.style.width=s+"px",l.style.height=a+"px");var o={lic:0};o.elem=t,o.md=!1,o.mo=!1,o.mdf=0,o.mof=0;var i=!0;if(t.style&&t.style.position&&("absolute"==(t.style.position+"").toLowerCase()&&(i=!1),"fixed"==(t.style.position+"").toLowerCase()&&(i=!1)),i&&(t.style.position="relative"),l.style.position="absolute",l.style.opacity=0,l.style.left="0px",l.style.top="0px",t.appendChild(l),o.ho=l,o.alic=function(){this.lic++,3==this.lic&&(this.ho.style.opacity=1,this.onload)&&this.onload()},mos.push(o),o.setEnabled=function(t){t?(this.disabled=!1,this.upi.style.opacity=this.mof,this.downi.style.opacity=this.mdf,this.elem.style.opacity=1,this.elem.style.cursor="pointer"):(this.disabled=!0,this.upi.style.opacity=0,this.downi.style.opacity=0,this.elem.style.opacity=.38,this.elem.style.cursor="default")},e)for(i=1;3>=i;i++){var n=document.createElement("img");n.draggable=!1,n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.border=0,n.width=s,n.height=a,n.className="nsi",l.appendChild(n),1==i?(o.normi=n,n.onload=function(){for(var t=mos.length-1;t>=0;t--){var e=mos[t];if(e.normi==this){e.alic();break}}},n.src=e+".png"):2==i?(o.upi=n,n.style.opacity=0,n.onload=function(){for(var t=mos.length-1;t>=0;t--){var e=mos[t];if(e.upi==this){e.alic();break}}},n.src=e+"up.png"):3==i&&(o.downi=n,n.style.opacity=0,n.onload=function(){for(var t=mos.length-1;t>=0;t--){var e=mos[t];if(e.downi==this){e.alic();break}}},n.src=e+"down.png")}else l.style.opacity=1;return t.onmouseenter=function(){for(var t=mos.length-1;t>=0;t--){var e=mos[t];if(e.elem==this){e.disabled||e.mo||(e.mo=!0,e.onmouseenter&&e.onmouseenter(),-1==m_iv&&(m_iv=setInterval("hmos()",25)));break}}},t.onmouseleave=function(){for(var t=mos.length-1;t>=0;t--){var e=mos[t];if(e.elem==this){e.mo&&(e.mo=!1,e.onmouseleave&&e.onmouseleave(),-1==m_iv&&(m_iv=setInterval("hmos()",25)));break}}},t.onmousedown=function(t){for(var e=mos.length-1;e>=0;e--){var s=mos[e];if(s.elem==this){if(!s.disabled&&!s.md)return s.md=!0,s.onmousedown&&s.onmousedown(t,s),-1==m_iv&&(m_iv=setInterval("hmos()",25)),!1;break}}},t.onmouseup=t.ondragend=function(t){for(var e=mos.length-1;e>=0;e--){var s=mos[e];if(s.elem==this){s.md&&(s.mdf=1,s.md=!1,s.onmouseup&&(s.onmouseup(t,s),is_mobile)&&s.elem.onmouseleave(),-1==m_iv&&(m_iv=setInterval("hmos()",25)));break}}},swmup||(swmup=!0,window.onmouseup=window.ondragover=window.ondragend=function(){for(var t=mos.length-1;t>=0;t--){var e=mos[t];e.md&&(e.md=!1,-1==m_iv&&(m_iv=setInterval("hmos()",25)))}}),o}function hmos(){for(var t,e=!1,s=mos.length-1;s>=0;s--){var a=mos[s];t=!1,a.mo?1!=a.mof&&(e=!0,a.mof+=.33,1<=a.mof&&(a.mof=1),t=!0):0!=a.mof&&(e=!0,a.mof-=.2,0>=a.mof&&(a.mof=0),t=!0),t&&(a.upi.style.opacity=a.disabled?0:a.mof),t=!1,a.md?1!=a.mdf&&(e=!0,a.mdf+=.33,1<=a.mdf&&(a.mdf=1),t=!0):0!=a.mdf&&(e=!0,a.mdf-=.2,0>=a.mdf&&(a.mdf=0),t=!0),t&&(a.downi.style.opacity=a.disabled?0:a.mdf)}e||(clearInterval(m_iv),m_iv=-1)}function makeTextBtn(t,e,s,a,l){e||(e=56),e>56&&(e=56),s||(s=15),a||(a=14);var o=document.createElement("div");o.className="btnt nsi sadg"+l;var i=o.style;i.position="absolute",i.width="auto",i.color="#ffffff",i.fontWeight="bold",i.textAlign="center",i.fontFamily='Arial, "Helvetica Neue", Helvetica, sans-serif',i.fontSize=s+"px",o.textContent=t,i.cursor="pointer",document.body.appendChild(o);var n=Math.ceil(35+o.offsetWidth);document.body.removeChild(o),o.textContent="",i.width=n+"px",i.height=e+"px",i.lineHeight=e+"px",is_mobile||(i.boxShadow="0px 3px 20px rgba(0,0,0, .75)"),i.borderRadius=a+"px";var r=document.createElement("div"),i=r.style;i.position="absolute",i.left=i.top="0px",i.width=n+"px",i.height=e+"px",i.borderRadius=a+1+"px",i.opacity=0,r.className="sadu"+l;var c=document.createElement("div"),i=c.style;i.position="absolute",i.left=i.top="-1px",i.width=n+2+"px",i.height=e+2+"px",i.borderRadius=a+"px",i.opacity=0,c.className="sadd"+l;var p=mkBtn(o);return p.a=1,p.ho.appendChild(r),p.upi=r,p.ho.appendChild(c),p.downi=c,p.ts=s,p.ww=n,p.bgm=l,p.setText=function(t){var e=document.createElement("div");e.className="nsi sadg"+this.bgm;var s=e.style;s.position="absolute",s.width="auto",s.color="#ffffff",s.fontWeight="bold",s.textAlign="center",s.fontFamily='Arial, "Helvetica Neue", Helvetica, sans-serif',s.fontSize=this.ts+"px",e.textContent=t,document.body.appendChild(e),s=Math.ceil(35+e.offsetWidth),document.body.removeChild(e),this.btnf.textContent=t,this.ww=s,this.elem.style.width=s+"px",this.upi.style.width=s+"px",this.downi.style.width=s+2+"px",this.btnf.style.width=s+"px"},s=document.createElement("div"),o.appendChild(s),p.btnf=s,i=s.style,i.position="absolute",i.left=i.top="0px",i.width=n+"px",i.height=e+"px",i.borderRadius=a+"px",s.textContent=t,s.className="nsi",i.color="#ffffff",i.opacity=.9,p.ho.appendChild(s),p}function loginFade(){var t=Date.now(),e=(t-llgmtm)/25;llgmtm=t,login_fr+=.05*e,choosing_skin&&(login_fr+=.06*e),login_fr>=1?(login_fr=1,login.style.display="none",cstx.style.display="none",fbh.style.display="none",twth.style.display="none",cskh.style.display="none",grqh.style.display="none",plq.style.display="none",clq.style.display="none",social.style.display="none",login.style.opacity=1,cstx.style.opacity=1,fbh.style.opacity=1,twth.style.opacity=1,cskh.style.opacity=1,grqh.style.opacity=1,plq.style.opacity=1,clq.style.opacity=1,social.style.opacity=1,pskh.style.opacity=1,nskh.style.opacity=1,skodiv.style.opacity=1,tip_fr=-1,tips.style.display="none",mc.style.opacity=1,loch.style.opacity=1,clearInterval(login_iv),login_iv=-1,-1!=showlogo_iv&&(ncka=lgss=lga=1,showLogo(!0),-1!=showlogo_iv&&(clearInterval(showlogo_iv),showlogo_iv=-1))):(lgcsc=1+.1*Math.pow(login_fr,2),t=Math.round(lgbsc*lgcsc*1e5)/1e5,trf(login,"scale("+t+","+t+")"),login.style.opacity=1-login_fr,cstx.style.opacity=1-login_fr,fbh.style.opacity=1-login_fr,twth.style.opacity=1-login_fr,cskh.style.opacity=1-login_fr,grqh.style.opacity=1-login_fr,plq.style.opacity=1-login_fr,clq.style.opacity=1-login_fr,social.style.opacity=1-login_fr,pskh.style.opacity=login_fr,nskh.style.opacity=login_fr,skodiv.style.opacity=login_fr,mc.style.opacity=login_fr,loch.style.opacity=login_fr)}function rdgbg(){if(ggbg){gbgmc||(gbgmc=document.createElement("canvas")),gbgmc.width=mww,gbgmc.height=mhh;var t=gbgmc.getContext("2d");try{t.drawImage(gbgi,0,0,512,512,0,0,mww,mhh)}catch(e){}}}function newDeadpool(){return{os:[],end_pos:0,add:function(t){this.end_pos==this.os.length?this.os.push(t):this.os[this.end_pos]=t,this.end_pos++},get:function(){if(1<=this.end_pos){this.end_pos--;var t=this.os[this.end_pos];return this.os[this.end_pos]=null,t}return null}}}function gdnm(t){var e,s,a="",l="",o="",i=0,n=!1,r=!1;for(e=0;e<t.length;e++)s=t.charCodeAt(e),32==s?r||(r=!0,a+=" "):(r=!1,a+=String.fromCharCode(s));for(r=!1,e=0;e<t.length;e++)if(s=t.charCodeAt(e),(n=s>=48&&57>=s)||s>=65&&90>=s||s>=97&&122>=s)if(l+=String.fromCharCode(s),o+=String.fromCharCode(s),r=!1,n){if(i++,i>=7)return!1}else i=0;else r||(r=!0,o+=" ");for(t=a.toLowerCase(),e=flt_a.length-1;e>=0;e--)if(0<=t.indexOf(flt_a[e]))return!1;for(l=l.toLowerCase(),e=flt_g.length-1;e>=0;e--)if(0<=l.indexOf(flt_g[e]))return!1;for(o=o.toLowerCase().split(" "),e=o.length-1;e>=0;e--)for(l=flt_w.length-1;l>=0;l--)if(o[e]==flt_w[l])return!1;return!0}function pwr(t){for(var e=new Float32Array(125),s=0;125>s;s++)e[s]=Math.pow(t,s);return e}function pca(t){for(var e=new Float32Array(125),s=0;125>s;s++)e[s]=1-Math.pow(1-t,s);return e}function setMscps(t){if(t!=mscps){for(mscps=t,fmlts=[],fpsls=[],t=0;mscps>=t;t++)t>=mscps?fmlts.push(fmlts[t-1]):fmlts.push(Math.pow(1-t/mscps,2.25)),0==t?fpsls.push(0):fpsls.push(fpsls[t-1]+1/fmlts[t-1]);var e=fmlts[fmlts.length-1],s=fpsls[fpsls.length-1];for(t=0;2048>t;t++)fmlts.push(e),fpsls.push(s)}}function startShowGame(){llgmtm=Date.now(),login_iv=setInterval("loginFade()",25),mc.style.opacity=0,mc.style.display="inline",lbh.style.opacity=lbs.style.opacity=lbn.style.opacity=lbp.style.opacity=lbf.style.opacity=vcm.style.opacity=0,loch.style.opacity=0,lb_fr=-1}function setSkin(t,e){if(t.rcv=e,t.er=6,t.ec="#ffffff",t.eca=.75,t.ppa=1,t.ppc="#000000",t.antenna=!1,19==e){t.ec="#ee5500",t.er=4.5,t.ppa=0,t.antenna=!0,t.atba=0,t.atc1="#505050",t.atc2="#FFFFFF",t.atia=.5,t.apbs=!0;var s=9;for(t.atx=new Float32Array(s),t.aty=new Float32Array(s),t.atvx=new Float32Array(s),t.atvy=new Float32Array(s),t.atax=new Float32Array(s),t.atay=new Float32Array(s),--s;s>=0;s--)t.atx[s]=t.xx,t.aty[s]=t.yy;t.bulb=rabulb,t.blbx=-10,t.blby=-10,t.blbw=20,t.blbh=20,t.bsc=1,t.blba=1}else if(24==e){for(t.antenna=!0,t.atba=0,t.atc1="#00688c",t.atc2="#64c8e7",t.atwg=!0,t.atia=.35,t.abrot=!1,s=8,t.atx=new Float32Array(s),t.aty=new Float32Array(s),t.atvx=new Float32Array(s),t.atvy=new Float32Array(s),t.atax=new Float32Array(s),t.atay=new Float32Array(s),--s;s>=0;s--)t.atx[s]=t.xx,t.aty[s]=t.yy;t.bulb=acbulb,t.blbx=-10,t.blby=-10,t.blbw=20,t.blbh=20,t.bsc=1,t.blba=.75}else if(25==e){for(t.ec="#ff5609",t.eca=1,t.antenna=!0,t.atba=0,t.atc1="#000000",t.atc2="#6625c7",t.atia=1,t.abrot=!0,s=9,t.atx=new Float32Array(s),t.aty=new Float32Array(s),t.atvx=new Float32Array(s),t.atvy=new Float32Array(s),t.atax=new Float32Array(s),t.atay=new Float32Array(s),--s;s>=0;s--)t.atx[s]=t.xx,t.aty[s]=t.yy;t.bulb=cdbulb,t.blbx=-5,t.blby=-10,t.blbw=20,t.blbh=20,t.bsc=1.6,t.blba=1}s=null,9==e?s=[7,9,7,9,7,9,7,9,7,9,7,10,10,10,10,10,10,10,10,10]:10==e?s=[9,9,9,9,9,1,1,1,1,1,7,7,7,7,7]:11==e?s=[11,11,11,11,11,7,7,7,7,7,12,12,12,12,12]:12==e?s=[7,7,7,7,7,9,9,9,9,9,13,13,13,13,13]:13==e?s=[14,14,14,14,14,9,9,9,9,9,7,7,7,7,7]:14==e?s=[9,9,9,9,9,9,9,7,7,7,7,7,7,7]:15==e?s=[0,1,2,3,4,5,6,7,8]:16==e?s=[15,15,15,15,15,15,15,4,4,4,4,4,4,4]:17==e?s=[9,9,9,9,9,9,9,16,16,16,16,16,16,16]:18==e?s=[7,7,7,7,7,7,7,9,9,9,9,9,9,9]:19==e?s=[9]:20==e?s=[3,3,3,3,3,0,0,0,0,0]:21==e?s=[3,3,3,3,3,3,3,18,18,18,18,18,18,20,19,20,19,20,19,20,18,18,18,18,18,18]:22==e?s=[5,5,5,5,5,5,5,9,9,9,9,9,9,9,13,13,13,13,13,13,13]:23==e?s=[16,16,16,16,16,16,16,18,18,18,18,18,18,18,7,7,7,7,7,7,7]:24==e?s=[23,23,23,23,23,23,23,23,23,18,18,18,18,18,18,18,18,18]:25==e?s=[21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22]:e%=9,s&&(e=s[0]),t.rbcs=s,t.cv=e}function newSnake(t,e,s,a,l,o){var i={};return i.id=t,i.xx=e,i.yy=s,setSkin(i,a),a=i.cv,i.fnfr=0,i.na=1,i.chl=0,i.tsp=0,i.sfr=0,i.rr=Math.min(255,rrs[a]+Math.floor(20*Math.random())),i.gg=Math.min(255,ggs[a]+Math.floor(20*Math.random())),i.bb=Math.min(255,bbs[a]+Math.floor(20*Math.random())),t="00"+Math.min(255,Math.max(0,Math.round(i.rr))).toString(16),e="00"+Math.min(255,Math.max(0,Math.round(i.gg))).toString(16),s="00"+Math.min(255,Math.max(0,Math.round(i.bb))).toString(16),t=t.substr(t.length-2),e=e.substr(e.length-2),s=s.substr(s.length-2),i.cs="#"+t+e+s,t="00"+Math.min(255,Math.max(0,Math.round(.4*i.rr))).toString(16),e="00"+Math.min(255,Math.max(0,Math.round(.4*i.gg))).toString(16),s="00"+Math.min(255,Math.max(0,Math.round(.4*i.bb))).toString(16),t=t.substr(t.length-2),e=e.substr(e.length-2),s=s.substr(s.length-2),i.cs04="#"+t+e+s,t="00"+Math.min(255,Math.max(0,Math.round(.5*(255+i.rr)))).toString(16),e="00"+Math.min(255,Math.max(0,Math.round(.5*(255+i.gg)))).toString(16),s="00"+Math.min(255,Math.max(0,Math.round(.5*(255+i.bb)))).toString(16),t=t.substr(t.length-2),e=e.substr(e.length-2),s=s.substr(s.length-2),i.csw="#"+t+e+s,i.sc=1,i.ssp=nsp1+nsp2*i.sc,i.fsp=i.ssp+.1,i.msp=nsp3,i.fxs=new Float32Array(rfc),i.fys=new Float32Array(rfc),i.fchls=new Float32Array(rfc),i.fpos=0,i.ftg=0,i.fx=0,i.fy=0,i.fchl=0,i.fas=new Float32Array(afc),i.fapos=0,i.fatg=0,i.fa=0,i.ehang=l,i.wehang=l,i.ehl=1,i.msl=42,i.fam=0,i.ang=l,i.eang=l,i.wang=l,i.rex=0,i.rey=0,i.sp=2,o?(i.lnp=o[o.length-1],i.pts=o,i.sct=o.length,o[0].dying&&i.sct--):(i.pts=[],i.sct=0),i.flpos=0,i.fls=new Float32Array(lfc),i.fl=0,i.fltg=0,i.tl=i.sct+i.fam,i.cfl=i.tl,i.scang=1,i.dead_amt=0,i.alive_amt=0,snakes.splice(0,0,i),os["s"+i.id]=i}function snl(t){var e=t.tl;t.tl=t.sct+t.fam;for(var e=t.tl-e,s=t.flpos,a=0;lfc>a;a++)t.fls[s]-=e*lfas[a],s++,s>=lfc&&(s=0);t.fl=t.fls[t.flpos],t.fltg=lfc,t==snake&&(wumsts=!0)}function newFood(t,e,s,a,l,o){var i={};return i.id=t,i.xx=e,i.yy=s,i.rx=e,i.ry=s,i.rsp=l?2:1,i.cv=o,i.rad=1e-5,i.sz=a,t=per_color_imgs[i.cv],i.cv2=Math.floor(t.ic*gsc*i.sz/16.5),0>i.cv2&&(i.cv2=0),i.cv2>=t.ic&&(i.cv2=t.ic-1),testing&&(window.biggestcv2||(window.biggestcv2=i.cv2),i.cv2>window.biggestcv2&&(window.biggestcv2=i.cv2,console.log("biggest cv2 seen: "+i.cv2+" out of "+(t.ic-1)+" (fo.sz = "+i.sz+" which means its server-side rad is "+5*i.sz+")"))),i.fi=t.imgs[i.cv2],i.fw=t.fws[i.cv2],i.fh=t.fhs[i.cv2],i.fw2=t.fw2s[i.cv2],i.fh2=t.fh2s[i.cv2],i.ofi=t.oimgs[i.cv2],i.ofw=t.ofws[i.cv2],i.ofh=t.ofhs[i.cv2],i.ofw2=t.ofw2s[i.cv2],i.ofh2=t.ofh2s[i.cv2],i.gcv=Math.floor(t.ic*gsc*(.25+.75*i.sz/16.5)),0>i.gcv&&(i.gcv=0),i.gcv>=t.ic&&(i.gcv=t.ic-1),i.gfi=t.gimgs[i.gcv],i.gfw=t.gfws[i.gcv],i.gfh=t.gfhs[i.gcv],i.gfw2=t.gfw2s[i.gcv],i.gfh2=t.gfh2s[i.gcv],i.g2cv=Math.floor(t.ic*gsc*2*(.25+.75*i.sz/16.5)),0>i.g2cv&&(i.g2cv=0),i.g2cv>=t.ic&&(i.g2cv=t.ic-1),i.g2fi=t.gimgs[i.g2cv],i.g2fw=t.gfws[i.g2cv],i.g2fh=t.gfhs[i.g2cv],i.g2fw2=t.gfw2s[i.g2cv],i.g2fh2=t.gfh2s[i.g2cv],i.fr=0,i.gfr=64*Math.random(),i.gr=.65+.1*i.sz,i.wsp=.0225*(2*Math.random()-1),i.eaten_fr=0,i.eaten_fr4=0,foods[foods_c++]=i}function newPrey(t,e,s,a,l,o,i,n,r){var c={};return c.id=t,c.xx=e,c.yy=s,c.rad=1e-5,c.sz=a,c.cv=l,c.dir=o,c.wang=i,c.ang=n,c.sp=r,c.fr=0,c.gfr=64*Math.random(),c.gr=.5+.15*Math.random()+.1*c.sz,c.rr=Math.min(255,rrs[l]),c.gg=Math.min(255,ggs[l]),c.bb=Math.min(255,bbs[l]),t="00"+Math.min(255,Math.max(0,Math.round(c.rr))).toString(16),e="00"+Math.min(255,Math.max(0,Math.round(c.gg))).toString(16),s="00"+Math.min(255,Math.max(0,Math.round(c.bb))).toString(16),t=t.substr(t.length-2),e=e.substr(e.length-2),s=s.substr(s.length-2),c.cs="#"+t+e+s,c.cv2=Math.floor(per_color_imgs[c.cv].pr_imgs.length*gsc*c.sz/9),0>c.cv2&&(c.cv2=0),c.cv2>=per_color_imgs[c.cv].pr_imgs.length&&(c.cv2=per_color_imgs[c.cv].pr_imgs.length-1),c.fi=per_color_imgs[c.cv].pr_imgs[c.cv2],c.fw=per_color_imgs[c.cv].pr_fws[c.cv2],c.fh=per_color_imgs[c.cv].pr_fhs[c.cv2],c.fw2=per_color_imgs[c.cv].pr_fw2s[c.cv2],c.fh2=per_color_imgs[c.cv].pr_fh2s[c.cv2],c.gcv=per_color_imgs[c.cv].gimgs.length-1,c.gfi=per_color_imgs[c.cv].gimgs[c.gcv],c.gfw=per_color_imgs[c.cv].gfws[c.gcv],c.gfh=per_color_imgs[c.cv].gfhs[c.gcv],c.gfw2=per_color_imgs[c.cv].gfw2s[c.gcv],c.gfh2=per_color_imgs[c.cv].gfh2s[c.gcv],c.fxs=new Float32Array(rfc),c.fys=new Float32Array(rfc),c.fpos=0,c.ftg=0,c.fx=0,c.fy=0,c.eaten=!1,c.eaten_fr=0,c.eaten_fr4=0,preys.push(c),c}function resize(){if(ww=Math.ceil(window.innerWidth),hh=Math.ceil(window.innerHeight),ww!=lww||hh!=lhh){lww=ww,lhh=hh;var t=0;if(mbi){var e=ww/1245;mbi.width=1245*e,t=Math.ceil(260*e),mbi.height=t,hh-=t}ww-=wsu,loch.style.bottom=16+t+"px",lbf.style.bottom=4+t+"px",lbh.style.right=4+wsu+"px",lbs.style.right=4+wsu+"px",lbn.style.right=64+wsu+"px",lbp.style.right=230+wsu+"px",loch.style.right=16+wsu+"px",plq.style.right=10+wsu+"px",clq.style.left=Math.floor(ww/2-130)+"px",login.style.width=ww+"px",fbh.style.right=30+wsu+"px",twth.style.right=130+wsu+"px",cstx.style.right=240+wsu+"px",grqh.style.right=20+wsu+"px",pskh.style.left=Math.round(.25*ww-44)+"px",nskh.style.left=Math.round(.75*ww-44)+"px",skodiv.style.left=Math.round(ww/2-skodiv.offsetWidth/2)+"px",skodiv.style.top=Math.round(hh/2+120)+"px",pskh.style.top=Math.round(hh/2-44)+"px",nskh.style.top=Math.round(hh/2-44)+"px",ldmc.style.left=ww/2-64+"px",ldmc.style.top=hh/2-64+"px";var e=Math.sqrt(ww*ww+hh*hh),t=Math.ceil(1400*ww/e),s=Math.ceil(1400*hh/e);t>1100&&(s=Math.ceil(1100*s/t),t=1100),s>1100&&(t=Math.ceil(1100*t/s),s=1100),lgbsc=560>hh?Math.max(50,hh)/560:1,e=Math.round(lgbsc*lgcsc*1e5)/1e5,1==e?(trf(login,""),login.style.top="0px"):(login.style.top=-(Math.round(hh*(1-lgbsc)*1e5)/1e5)+"px",trf(login,"scale("+e+","+e+")")),(mww!=t||mhh!=s)&&(mww=t,mhh=s,mc.width=mww,mc.height=mhh,mwwp50=mww+50,mhhp50=mhh+50,mwwp150=mww+150,mhhp150=mhh+150,mww2=mww/2,mhh2=mhh/2,rdgbg()),csc=Math.min(ww/mww,hh/mhh),trf(mc,"scale("+csc+","+csc+")"),mc.style.left=Math.floor(ww/2-mww/2)+"px",mc.style.top=Math.floor(hh/2-mhh/2)+"px"}nbg.style.width=ww+"px",nbg.style.height=hh+"px",redraw()}function setAcceleration(t){if(null!=snake){if(snake.md=1==t,protocol_version>=5){var e=new Uint8Array(1);e[0]=1==t?253:254}else e=new Uint8Array(2),e[0]=109,e[1]=t;ws.send(e)}}function omu(t){setAcceleration(0)}function resetGame(){for(ws&&(ws.close(),ws=null),snake=null,want_close_socket=!1,snakes=[],foods=[],foods_c=0,preys=[],sectors=[],os={},rank=0,best_rank=999999999,biggest_snake_count=snake_count=0,lagging=wfpr=playing=connected=!1,j=vfc-1;j>=0;j--)fvxs[j]=0,fvys[j]=0;fvy=fvx=fvtg=0,lag_mult=1,cptm=0,gsc=sgsc}function connect(){if(0==sos.length)waiting_for_sos||(waiting_for_sos=!0,sos_ready_after_mtm=-1);else{if(waiting_for_sos=!1,sos_ready_after_mtm=-1,resetGame(),connecting=!0,start_connect_mtm=Date.now(),!forcing){for(var t=0;t<sos.length;t++)sos[t].ptm=9999999;for(t=clus.length-1;t>=0;t--){var e=clus[t];if(e&&0<e.ptms.length){for(var s=0,a=e.ptms.length-1;a>=0;a--)s+=e.ptms[a];for(s/=e.ptms.length,testing&&console.log("cluster "+t+" ping time: "+s),a=sos.length-1;a>=0;a--)sos[a].clu==t&&(sos[a].ptm=s)}}if("undefined"!=typeof rmsos)for(t=0;t<rmsos.length;t++)for(e="."+rmsos[t].a[0]+"."+rmsos[t].a[1]+"."+rmsos[t].a[2],s=rmsos[t].a[3],a=sos.length-1;a>=0;a--)0<=sos[a].ip.indexOf(e)&&sos[a].po==s&&sos.splice(a,1);for(sos.sort(function(t,e){return parseFloat(t.po)-parseFloat(e.po)}),bso=sos[Math.floor(Math.random()*sos.length)],t=sos.length-1;t>=0;t--)sos[t].tainted||sos[t].ptm<=bso.ptm&&30<sos[t].ac&&(bso=sos[t])}ws=new WebSocket("ws://"+bso.ip+":"+bso.po+"/slither"),ws.binaryType="arraybuffer",window.ws=ws,ws.onmessage=function(t){if(ws==this&&(t=new Uint8Array(t.data),rdps+=t.length,2<=t.length)){lptm=cptm,cptm=Date.now();var e=t[0]<<8|t[1],s=cptm-lptm;0==lptm&&(s=0),etm+=s-e,testing&&(rdpspc[t[2]]+=t.length);var a=String.fromCharCode(t[2]),e=3,l=t.length,s=t.length-2,o=t.length-3;if("a"==a)connecting=!1,playing=connected=!0,play_btn_click_mtm=-1,grd=t[e]<<16|t[e+1]<<8|t[e+2],e+=3,s=t[e]<<8|t[e+1],e+=2,sector_size=t[e]<<8|t[e+1],e+=2,sector_count_along_edge=t[e]<<8|t[e+1],e+=2,spangdv=t[e]/10,e++,nsp1=(t[e]<<8|t[e+1])/100,e+=2,nsp2=(t[e]<<8|t[e+1])/100,e+=2,nsp3=(t[e]<<8|t[e+1])/100,e+=2,mamu=(t[e]<<8|t[e+1])/1e3,e+=2,mamu2=(t[e]<<8|t[e+1])/1e3,e+=2,cst=(t[e]<<8|t[e+1])/1e3,e+=2,l>e&&(protocol_version=t[e]),setMscps(s),lbh.style.display="inline",lbs.style.display="inline",lbn.style.display="inline",lbp.style.display="inline",lbf.style.display="inline",vcm.style.display="inline",loch.style.display="inline",startShowGame();else if("e"==a||"E"==a||"3"==a||"4"==a||"5"==a){var i=t[e]<<8|t[e+1],e=e+2,r=l=-1,c=-1,p=-1;protocol_version>=6?6==s?(l="e"==a?1:2,r=2*t[e]*Math.PI/256,e++,c=2*t[e]*Math.PI/256,e++,p=t[e]/18):5==s?"e"==a?(r=2*t[e]*Math.PI/256,e++,p=t[e]/18):"E"==a?(l=1,c=2*t[e]*Math.PI/256,e++,p=t[e]/18):"4"==a?(l=2,c=2*t[e]*Math.PI/256,e++,p=t[e]/18):"3"==a?(l=1,r=2*t[e]*Math.PI/256,e++,c=2*t[e]*Math.PI/256):"5"==a&&(l=2,r=2*t[e]*Math.PI/256,e++,c=2*t[e]*Math.PI/256):4==s&&("e"==a?r=2*t[e]*Math.PI/256:"E"==a?(l=1,c=2*t[e]*Math.PI/256):"4"==a?(l=2,c=2*t[e]*Math.PI/256):"3"==a&&(p=t[e]/18)):protocol_version>=3?("3"!=a&&(8==s||7==s||6==s&&"3"!=a||5==s&&"3"!=a)&&(l="e"==a?1:2),(8==s||7==s||5==s&&"3"==a||6==s&&"3"==a)&&(r=2*(t[e]<<8|t[e+1])*Math.PI/65535,e+=2),(8==s||7==s||5==s&&"3"!=a||6==s&&"3"!=a)&&(c=2*(t[e]<<8|t[e+1])*Math.PI/65535,e+=2),(8==s||6==s||4==s)&&(p=t[e]/18)):((11==o||8==o||9==o||6==o)&&(l=t[e]-48,e++),(11==o||7==o||9==o||5==o)&&(r=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3),(11==o||8==o||9==o||6==o)&&(c=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3),(11==o||7==o||8==o||4==o)&&(p=(t[e]<<8|t[e+1])/1e3));var g=os["s"+i];if(g){if(-1!=l&&(g.dir=l),anguc++,-1!=r){for(g.ang==r&&angnuc++,t=(r-g.ang)%pi2,0>t&&(t+=pi2),t>Math.PI&&(t-=pi2),i=g.fapos,o=0;afc>o;o++)g.fas[i]-=t*afas[o],i++,i>=afc&&(i=0);g.fatg=afc,g.ang=r}-1!=c&&(g.wang==c&&wangnuc++,g.wang=c,g!=snake&&(g.eang=c)),-1!=p&&(g.sp=p,g.spang=g.sp/spangdv,1<g.spang&&(g.spang=1))}}else if("h"==a){var i=t[e]<<8|t[e+1],e=e+2,f=(t[e]<<16|t[e+1]<<8|t[e+2])/16777215;(g=os["s"+i])&&(g.fam=f,snl(g))}else if("r"==a){if(i=t[e]<<8|t[e+1],e+=2,g=os["s"+i]){for(o>=4&&(g.fam=(t[e]<<16|t[e+1]<<8|t[e+2])/16777215),o=0;o<g.pts.length;o++)if(!g.pts[o].dying){g.pts[o].dying=!0,g.sct--,g.sc=Math.min(6,1+(g.sct-2)/106),g.scang=.13+.87*Math.pow((7-g.sc)/6,2),g.ssp=nsp1+nsp2*g.sc,g.fsp=g.ssp+.1,g.wsep=6*g.sc,t=nsep/gsc,g.wsep<t&&(g.wsep=t);break}snl(g)}}else if("g"==a||"n"==a||"G"==a||"N"==a){if(playing&&(f="n"==a||"N"==a,i=t[e]<<8|t[e+1],e+=2,g=os["s"+i])){if(f)g.sct++;else for(o=0;o<g.pts.length;o++)if(!g.pts[o].dying){g.pts[o].dying=!0;break}var h=g.pts[g.pts.length-1],o=h,l=!1;if(protocol_version>=3?"g"==a||"n"==a?(s=t[e]<<8|t[e+1],e+=2,x=t[e]<<8|t[e+1],e+=2):(s=o.xx+t[e]-128,e++,x=o.yy+t[e]-128,e++):(s=(t[e]<<16|t[e+1]<<8|t[e+2])/5,e+=3,x=(t[e]<<16|t[e+1]<<8|t[e+2])/5,e+=3),f&&(g.fam=(t[e]<<16|t[e+1]<<8|t[e+2])/16777215),(h=points_dp.get())||(h={exs:[],eys:[],efs:[],ems:[]}),h.eiu=0,h.xx=s,h.yy=x,h.fx=0,h.fy=0,h.da=0,h.ebx=h.xx-o.xx,h.eby=h.yy-o.yy,g.pts.push(h),l=!0,g.iiv&&(t=g.xx+g.fx-h.xx,e=g.yy+g.fy-h.yy,h.fx+=t,h.fy+=e,h.exs[h.eiu]=t,h.eys[h.eiu]=e,h.efs[h.eiu]=0,h.ems[h.eiu]=1,h.eiu++),i=g.pts.length-3,i>=1)for(r=g.pts[i],a=n=0,o=i-1;o>=0;o--)i=g.pts[o],n++,t=i.xx,e=i.yy,4>=n&&(a=cst*n/4),i.xx+=(r.xx-i.xx)*a,i.yy+=(r.yy-i.yy)*a,g.iiv&&(t-=i.xx,e-=i.yy,i.fx+=t,i.fy+=e,i.exs[i.eiu]=t,i.eys[i.eiu]=e,i.efs[i.eiu]=0,i.ems[i.eiu]=2,i.eiu++),r=i;for(g.sc=Math.min(6,1+(g.sct-2)/106),g.scang=.13+.87*Math.pow((7-g.sc)/6,2),g.ssp=nsp1+nsp2*g.sc,g.fsp=g.ssp+.1,g.wsep=6*g.sc,t=nsep/gsc,g.wsep<t&&(g.wsep=t),f&&snl(g),g.lnp=h,g==snake&&(ovxx=snake.xx+snake.fx,ovyy=snake.yy+snake.fy),h=etm/8*g.sp/4,h*=lag_mult,o=g.chl-1,g.chl=h/g.msl,a=g.xx,i=g.yy,g.xx=s+Math.cos(g.ang)*h,g.yy=x+Math.sin(g.ang)*h,t=g.xx-a,e=g.yy-i,s=g.chl-o,i=g.fpos,o=0;rfc>o;o++)g.fxs[i]-=t*rfas[o],g.fys[i]-=e*rfas[o],g.fchls[i]-=s*rfas[o],i++,i>=rfc&&(i=0);if(g.fx=g.fxs[g.fpos],g.fy=g.fys[g.fpos],g.fchl=g.fchls[g.fpos],g.ftg=rfc,l&&(g.ehl=0),g==snake){for(view_xx=snake.xx+snake.fx,view_yy=snake.yy+snake.fy,t=view_xx-ovxx,e=view_yy-ovyy,i=fvpos,o=0;vfc>o;o++)fvxs[i]-=t*vfas[o],fvys[i]-=e*vfas[o],i++,i>=vfc&&(i=0);fvtg=vfc}}}else if("l"==a){if(playing){wumsts=!0,r=h=x="",p=c=0,-1==lb_fr&&-1==dead_mtm&&(lb_fr=0);var y=t[e];for(e++,rank=t[e]<<8|t[e+1],best_rank>rank&&(best_rank=rank),e+=2,snake_count=t[e]<<8|t[e+1],snake_count>biggest_snake_count&&(biggest_snake_count=snake_count),e+=2;l>e;){var m=t[e]<<8|t[e+1],e=e+2,f=(t[e]<<16|t[e+1]<<8|t[e+2])/16777215,e=e+3,g=t[e]%9;for(e++,s=t[e],e++,p++,a="",o=0;s>o;o++)i=t[e],a+=String.fromCharCode(i),e++;p!=y&&(gdnm(a)||(a=""));for(var d="",o=0;s>o;o++)i=a.charCodeAt(o),d=38==i?d+"&amp;":60==i?d+"&lt;":62==i?d+"&gt;":32==i?d+"&nbsp;":d+String.fromCharCode(i);a=d,c++,score=Math.floor(150*(fpsls[m]+f/fmlts[m]-1)-50)/10,i=p==y?1:.7*(.3+.7*(1-c/10)),x+='<span style="opacity:'+i+"; color:"+per_color_imgs[g].cs+';">'+score+"</span><BR>",h+='<span style="opacity:'+i+"; color:"+per_color_imgs[g].cs+";"+(p==y?"font-weight:bold;":"")+'">'+a+"</span><BR>",r+='<span style="opacity:'+i+"; color:"+per_color_imgs[g].cs+';">#'+c+"</span><BR>"}lbs.innerHTML=x,lbn.innerHTML=h,lbp.innerHTML=r}}else if("v"==a)2==t[e]?(want_close_socket=!0,want_victory_message=!1,want_hide_victory=1,hvfr=0):(dead_mtm=Date.now(),play_btn.setEnabled(!0),s=Math.floor(150*(fpsls[snake.sct]+snake.fam/fmlts[snake.sct]-1)-50)/10,twt.href="http://twitter.com/intent/tweet?status="+encodeURIComponent("I got a length of "+s+" in http://slither.io! Can you beat that? #slitherio"),x="Your final length was","DE"==country?x="Deine endgültige Länge war":"FR"==country?x="Votre longueur finale était de":"BR"==country&&(x="Seu comprimento final foi de"),l="",s>1e3&&(l="!"),lastscore.innerHTML='<span style="opacity: .45;">'+x+" </span><b>"+s+"</b>"+l,s="Play Again","FR"==country?s="Jouer":"BR"==country&&(s="Joga"),play_btn.setText(String.fromCharCode(160)+s+String.fromCharCode(160)),1==t[e]?(nick_holder.style.display="none",playh.style.display="none",smh.style.display="none",victory_holder.style.display="inline",saveh.style.display="block",want_victory_focus=want_victory_message=!0,victory.disabled=!1,save_btn.setEnabled(!0)):want_close_socket=!0);else if("w"==a)if(l=t[e],e++,s=t[e]<<8|t[e+1],e+=2,x=t[e]<<8|t[e+1],1==l)g={},g.xx=s,g.yy=x,sectors.push(g);else{for(h=cm1=foods_c-1;h>=0;h--)o=foods[h],o.sx==s&&o.sy==x&&(h==cm1?foods[h]=null:(foods[h]=foods[cm1],foods[cm1]=null),foods_c--,cm1--);for(h=sectors.length-1;h>=0;h--)g=sectors[h],g.xx==s&&g.yy==x&&sectors.splice(h,1)}else if("m"==a){for(m=t[e]<<16|t[e+1]<<8|t[e+2],e+=3,f=(t[e]<<16|t[e+1]<<8|t[e+2])/16777215,e+=3,x=Math.floor(150*(fpsls[m]+f/fmlts[m]-1)-50)/10,s=t[e],e++,o="",h=0;s>h;h++)o+=String.fromCharCode(t[e]),e++;for(s="";l>e;)s+=String.fromCharCode(t[e]),e++;o=o.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;"),s=s.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;"),x>0&&(t="",0<s.length&&(t+="<span style='font-size:17px;'><b><i><span style='opacity: .5;'>&quot;</span>"+s+"<span style='opacity: .5;'>&quot;</span></i></b></span><BR><div style='height: 5px;'></div>"),0<o.length?(t=0<s.length?t+("<i><span style='opacity: .5;'>- </span><span style='opacity: .75;'><b>"+o+"</b></span><span style='opacity: .5;'>, today's longest</span></i>"):"<i><span style='opacity: .5;'>Today's longest was </span><span style='opacity: .75;'><b>"+o+"</b></span></i>",t+="<br><i><span style='opacity: .5;'>with a length of </span><span style='opacity: .65;'><b>"+x+"</b></span></i>"):t=0<s.length?t+"<i><span style='opacity: .5;'>- </span><span style='opacity: .5;'>today's longest</span></i>"+("<br><i><span style='opacity: .5;'>with a length of </span><span style='opacity: .65;'><b>"+x+"</b></span></i>"):t+("<i><span style='opacity: .5;'>Today's longest: </span><span style='opacity: .75;'><b>"+x+"</b></span></i>"),vcm.innerHTML=t)}else if("p"==a)wfpr=!1,lagging&&(etm*=lag_mult,lagging=!1);else if("u"==a){o=asmc.getContext("2d"),o.clearRect(0,0,80,80),o.fillStyle="#FFFFFF";for(var x=s=0;l>e&&!(x>=80);)if(i=t[e++],i>=128)for(i-=128,h=0;i>h&&(s++,!(s>=80&&(s=0,x++,x>=80)));h++);else for(h=0;7>h&&(0<(i&u_m[h])&&o.fillRect(s,x,1,1),s++,!(s>=80&&(s=0,x++,x>=80)));h++);}else if("s"==a){if(playing)if(i=t[e]<<8|t[e+1],e+=2,o>6){for(r=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3,e++,c=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3,p=(t[e]<<8|t[e+1])/1e3,e+=2,f=(t[e]<<16|t[e+1]<<8|t[e+2])/16777215,e+=3,g=t[e],e++,y=[],m=(t[e]<<16|t[e+1]<<8|t[e+2])/5,e+=3,d=(t[e]<<16|t[e+1]<<8|t[e+2])/5,e+=3,s=t[e],e++,a="",o=0;s>o;o++)a+=String.fromCharCode(t[e]),e++;for(var w=o=x=s=0,v=!1;l>e;)o=s,w=x,v?(s+=(t[e]-127)/2,e++,x+=(t[e]-127)/2,e++):(s=(t[e]<<16|t[e+1]<<8|t[e+2])/5,e+=3,x=(t[e]<<16|t[e+1]<<8|t[e+2])/5,e+=3,o=s,w=x,v=!0),(h=points_dp.get())||(h={exs:[],eys:[],efs:[],ems:[]}),h.eiu=0,h.xx=s,h.yy=x,h.fx=0,h.fy=0,h.da=0,h.ebx=s-o,h.eby=x-w,y.push(h);g=newSnake(i,m,d,g,r,y),null==snake?(view_xx=s,view_yy=x,snake=g,g.nk=my_nick):(g.nk=a,gdnm(a)||(g.nk="")),g.eang=g.wang=c,g.sp=p,g.spang=g.sp/spangdv,1<g.spang&&(g.spang=1),g.fam=f,g.sc=Math.min(6,1+(g.sct-2)/106),g.scang=.13+.87*Math.pow((7-g.sc)/6,2),g.ssp=nsp1+nsp2*g.sc,g.fsp=g.ssp+.1,g.wsep=6*g.sc,t=nsep/gsc,g.wsep<t&&(g.wsep=t),g.sep=g.wsep,snl(g)}else for(t=1==t[e],h=snakes.length-1;h>=0;h--)if(snakes[h].id==i){snakes[h].id=-1234,t?(snakes[h].dead=!0,snakes[h].dead_amt=0,snakes[h].edir=0):snakes.splice(h,1),delete os["s"+i];break}}else if("F"==a)if(protocol_version>=4){for(a=!1;l>e;)g=t[e],e++,s=t[e]<<8|t[e+1],e+=2,x=t[e]<<8|t[e+1],e+=2,o=t[e]/5,e++,i=x*grd*3+s,o=newFood(i,s,x,o,!0,g),a||(a=!0,h=Math.floor(s/sector_size),f=Math.floor(x/sector_size)),o.sx=h,o.sy=f;g={},g.xx=h,g.yy=f,sectors.push(g)}else for(h=t[e]<<8|t[e+1],e+=2,f=t[e]<<8|t[e+1],e+=2,g={},g.xx=h,g.yy=f,sectors.push(g);l>e;)i=t[e]<<16|t[e+1]<<8|t[e+2],e+=3,g=t[e],e++,s=sector_size*(h+t[e]/255),e++,x=sector_size*(f+t[e]/255),e++,o=t[e]/5,e++,o=newFood(i,s,x,o,!0,g),o.sx=h,o.sy=f;else if("b"==a||"f"==a)protocol_version>=4?(g=t[e],e++,o>4&&(s=t[e]<<8|t[e+1],e+=2,x=t[e]<<8|t[e+1],i=x*grd*3+s,o=t[e+2]/5,o=newFood(i,s,x,o,"b"==a,g),o.sx=Math.floor(s/sector_size),o.sy=Math.floor(x/sector_size))):(i=t[e]<<16|t[e+1]<<8|t[e+2],e+=3,o>4&&(g=t[e],e++,h=t[e]<<8|t[e+1],e+=2,f=t[e]<<8|t[e+1],e+=2,s=sector_size*(h+t[e]/255),e++,x=sector_size*(f+t[e]/255),e++,o=t[e]/5,o=newFood(i,s,x,o,"b"==a,g),o.sx=h,o.sy=f));else if("c"==a){for(protocol_version>=4?(s=t[e]<<8|t[e+1],e+=2,x=t[e]<<8|t[e+1],e+=2,i=x*grd*3+s):(i=t[e]<<16|t[e+1]<<8|t[e+2],e+=3),h=cm1=foods_c-1;h>=0;h--)if(o=foods[h],o.id==i){o.eaten=!0,l>=e+2?(t=t[e]<<8|t[e+1],o.eaten_by=os["s"+t],o.eaten_fr=0):(h==cm1?foods[h]=null:(foods[h]=foods[cm1],foods[cm1]=null),foods_c--,cm1--),i=-1;break}-1!=i&&console.log("wtf")}else if("j"==a){for(i=t[e]<<8|t[e+1],e+=2,s=1+3*(t[e]<<8|t[e+1]),e+=2,x=1+3*(t[e]<<8|t[e+1]),e+=2,l=null,h=preys.length-1;h>=0;h--)if(preys[h].id==i){l=preys[h];break}if(l){for(h=etm/8*l.sp/4,h*=lag_mult,a=l.xx,i=l.yy,15==o?(l.dir=t[e]-48,e++,l.ang=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3,l.wang=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3,l.sp=(t[e]<<8|t[e+1])/1e3):11==o?(l.ang=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3,l.sp=(t[e]<<8|t[e+1])/1e3):12==o?(l.dir=t[e]-48,e++,l.wang=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3,l.sp=(t[e]<<8|t[e+1])/1e3):13==o?(l.dir=t[e]-48,e++,l.ang=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3,l.wang=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215):9==o?l.ang=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215:10==o?(l.dir=t[e]-48,e++,l.wang=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215):8==o&&(l.sp=(t[e]<<8|t[e+1])/1e3),l.xx=s+Math.cos(l.ang)*h,l.yy=x+Math.sin(l.ang)*h,t=l.xx-a,e=l.yy-i,i=l.fpos,o=0;rfc>o;o++)l.fxs[i]-=t*rfas[o],l.fys[i]-=e*rfas[o],i++,i>=rfc&&(i=0);l.fx=l.fxs[l.fpos],l.fy=l.fys[l.fpos],l.ftg=rfc}}else if("y"==a)if(i=t[e]<<8|t[e+1],e+=2,2==o){for(h=preys.length-1;h>=0;h--)if(l=preys[h],l.id==i){preys.splice(h,1);break}}else if(4==o){for(t=t[e]<<8|t[e+1],h=preys.length-1;h>=0;h--)if(l=preys[h],l.id==i){l.eaten=!0,l.eaten_by=os["s"+t],l.eaten_by?l.eaten_fr=0:preys.splice(h,1);break}}else g=t[e],e++,s=(t[e]<<16|t[e+1]<<8|t[e+2])/5,e+=3,x=(t[e]<<16|t[e+1]<<8|t[e+2])/5,e+=3,o=t[e]/5,e++,l=t[e]-48,e++,c=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3,r=2*(t[e]<<16|t[e+1]<<8|t[e+2])*Math.PI/16777215,e+=3,p=(t[e]<<8|t[e+1])/1e3,newPrey(i,s,x,o,g,l,c,r,p)}},ws.onerror=function(t){},ws.onclose=function(t){ws==this&&(playing=connected=!1)},ws.onopen=function(t){if(ws==this){t=asciize(nick.value),24<t.length&&(t=t.substr(0,24)),my_nick=t;var e=Math.floor(9*Math.random());try{var s=localStorage.snakercv;s==""+Number(s)&&(e=Number(s))}catch(a){}for(s=new Uint8Array(3+t.length),s[0]=115,s[1]=5,s[2]=e,e=0;e<t.length;e++)s[e+3]=t.charCodeAt(e);ws.send(s),high_quality=!0,gla=1,wdfg=0,qsm=1,0==want_quality&&(high_quality=!1,gla=0,qsm=1.7),1==render_mode&&(high_quality=!1,gla=0),lpstm=Date.now()}}}}function asciize(t){var e,s,a;s=t.length;var l=!1;for(e=0;s>e;e++)if(a=t.charCodeAt(e),32>a||a>127){l=!0;break}if(l){for(l="",e=0;s>e;e++)a=t.charCodeAt(e),l=32>a||a>127?l+" ":l+String.fromCharCode(a);
return l}return t}function showLogo(t){var e=Date.now(),s=(e-lgtm)/25;lgtm=e;var a,l,o,i,n,r,c,p,g,f,h,y,m,d,x;if(lgfr+=s,0==lts[lts.length-1].mwig&&1==lga&&1==lgss&&1==ncka)clearInterval(showlogo_iv),showlogo_iv=-1;else{for((t||1!=lga)&&(lga+=.05*s,lga>=1&&(lga=1),lmc2.style.opacity=lga),1!=lgss&&(lgss+=.00375*s,lgss>=1&&(lgss=1)),(t||1!=ncka)&&(ncka+=.006*s,ncka>=1&&(ncka=1),nick_holder.style.opacity=Math.min(1,6*ncka),is_mobile||(smh.style.opacity=Math.max(0,Math.min(1,5*(ncka-.05)))),ncka>=.01&&(playh.style.opacity=Math.min(1,5*(ncka-.01)))),lctx.clearRect(0,0,lw,lh),e=0;e<lts.length;e++){var w=lts[e],v=w.pts,b=w.kc,u=w.ws,_=w.wr,k=w.qm;a=w.sp;var M=w.sz;x=w.r;var I=w.mwig;t&&(w.wch=!0,I=1e-7),w.wch&&0!=I&&(I*=.982,I-=.001*s,1==render_mode&&(I-=.005*s),0>=I&&(I=0),w.mwig=I),x||(x=1),lctx.beginPath(),9>e?(o=ctx.createLinearGradient(0,70*lgsc,0,230*lgsc),o.addColorStop(0,"#80FFA0"),o.addColorStop(1,"#008040")):(o=ctx.createLinearGradient(0,50*lgsc,0,265*lgsc),o.addColorStop(0,"#9850FF"),o.addColorStop(1,"#281060")),lctx.fillStyle=o,m=!1,d=0,o=v[0],i=v[1],g=o,f=i;var z=lgfr*a;for(h=2;h<v.length;h+=4){a=o,l=i,cx2=v[h],cy2=v[h+1],o=v[h+2],i=v[h+3];for(var C=1;b>=C;C++){d++;var q=C/b;n=a+(cx2-a)*q,r=l+(cy2-l)*q,c=cx2+(o-cx2)*q,p=cy2+(i-cy2)*q,n+=(c-n)*q,r+=(p-r)*q,g=Math.atan2(r-f,n-g),m?(g-y>Math.PI?g-=2*Math.PI:g-y<-Math.PI&&(g+=2*Math.PI),y+=.05*(g-y),y%=2*Math.PI):(m=!0,y=g),g=n,f=r,n+=Math.cos(Math.PI/2+y)*Math.sin(z)*u*I,r+=Math.sin(Math.PI/2+y)*Math.sin(z)*u*I,z-=.76*k*u,u+=_,lctx.beginPath(),p=1.15*M*Math.min(1,lgsc*(.2+.8*lga)*(30*lgss*x-d/20-e/2)),p>.5&&(lctx.arc(n*lgsc,r*lgsc,p,0,pi2),w.wch=!0),lctx.fill()}}}lctx2.clearRect(0,0,lw,lh),lctx2.shadowColor="#000000",lctx2.shadowBlur=16,lctx2.shadowOffsetY=7,lctx2.drawImage(lmc,0,0)}}function loadSos(t){if(!forcing&&0<t.length){sos=[],clus=[],t.charAt(0);for(var e,s=1,a={},l=0,a=l=0,o=0,i=0,n=[],r=[],c=[],p=[];s<t.length;)if(e=(t.charCodeAt(s++)-97-i)%26,0>e&&(e+=26),o*=16,o+=e,i+=7,1==a){if(0==l)n.push(o),4==n.length&&l++;else if(1==l)r.push(o),3==r.length&&l++;else if(2==l)c.push(o),3==c.length&&l++;else if(3==l&&(p.push(o),1==p.length)){for(a={},l=e=0;l<r.length;l++)e*=256,e+=r[l];for(l=r=0;l<c.length;l++)r*=256,r+=c[l];a.ip=n.join("."),a.po=e,a.ac=r,a.clu=p[0],clus[a.clu]?n=clus[a.clu]:(n={},clus[a.clu]=n,n.sis=[],n.ptms=[]),a.cluo=n,sos.push(a),n=[],r=[],c=[],p=[],l=0}a=o=0}else a++;for(s=sos.length-1;s>=0;s--)if(a=1,n=sos[s].cluo){for(l=n.sis.length-1;l>=0;l--)if(n.sis[l].ip==sos[s].ip){a=0;break}1==a&&n.sis.push({ip:sos[s].ip})}for(s=clus.length-1;s>=0;s--)if((n=clus[s])&&0<n.sis.length){l=Math.floor(Math.random()*n.sis.length),t=n.sis[l].ip,i=null;try{i=new WebSocket("ws://"+t+":80/ptc")}catch(g){i=null}i&&(i.binaryType="arraybuffer",i.onerror=function(t){},i.onmessage=function(t){if(t=new Uint8Array(t.data),1==t.length&&112==t[0])for(t=clus.length-1;t>=0;t--){var e=clus[t];if(e&&e.ps==this){var s=Date.now()-e.stm;testing&&console.log(" ping time for cluster "+t+": "+s),e.ptms.push(s),4>e.ptms.length?(e.stm=Date.now(),t=new Uint8Array(1),t[0]=112,this.send(t)):(waiting_for_sos&&-1==sos_ready_after_mtm&&(sos_ready_after_mtm=Date.now()+2e3),this.close(),e.ps=null);break}}},i.onopen=function(t){t=!1;for(var e=clus.length-1;e>=0;e--){var s=clus[e];if(s&&s.ps==this){s.stm=Date.now(),t=new Uint8Array(1),t[0]=112,this.send(t),t=!0;break}}t||this.close()},n.ps=i)}}}var testing=!1;0<=window.location.href.indexOf("/testing")&&(testing=!0);var forcing=!1,ua=navigator.userAgent.toLowerCase(),is_android=0<=ua.indexOf("android"),is_amazon=0<=ua.indexOf("kindle")||0<=ua.indexOf("silk/"),uua=navigator.userAgent,is_ios=0<=uua.indexOf("iPad")||0<=uua.indexOf("iPhone")||0<=uua.indexOf("iPod"),is_mobile=0<=ua.indexOf("mobile"),is_firefox=-1<ua.indexOf("firefox"),is_ie8oo=window.attachEvent&&!window.addEventListener,is_safari=is_firefox=!1;0<=ua.indexOf("safari")&&-1==ua.indexOf("chrome")&&(is_safari=!0);var no_raf=!1,raf=function(t){};window.requestAnimationFrame?raf=window.requestAnimationFrame:window.mozRequestAnimationFrame?raf=window.mozRequestAnimationFrame:window.webkitRequestAnimationFrame?raf=window.webkitRequestAnimationFrame:no_raf=!0,is_mobile||(no_raf=!0);var no_raf=!0,a,i,j,k,l,m,n,o,r,fj,d,d2,qq,sc,agpu="translateZ(0)",ang,sang,vang,pi2=2*Math.PI,animating=!1,startAnimation=function(){animating=!0,no_raf?is_mobile?setInterval("oef()",33):is_safari?setInterval("oef()",33):setInterval("oef()",20):raf(oef)},ois=[],wic=0,ldi=function(t){wic++;var e={},s=document.createElement("img");return e.ii=s,e.sc=1,s.onload=function(){for(var t=ois.length-1;t>=0;t--)if(ois[t].ii==this){t=ois[t],t.ww=this.width,t.hh=this.height,t.loaded=!0,t.onload&&t.onload();break}wic--,0==wic&&startAnimation()},e.src=t,ois.push(e),e},nbg=document.getElementById("nbg"),nzbg,sadg,sadu,sadd,p,xx,yy,grw,grh,elem,map,imgd,ctx;elem=document.createElement("canvas");var rw=64,rh=64;for(elem.width=rw,elem.height=rh,ctx=elem.getContext("2d"),map=ctx.getImageData(0,0,rw,rh),imgd=map.data,l=imgd.length,p=0;l>p;p+=4).5>Math.random()?imgd[p]=imgd[p+1]=imgd[p+2]=0:(imgd[p]=44,imgd[p+1]=56,imgd[p+2]=68),imgd[p+3]=Math.floor(32*Math.random());for(ctx.putImageData(map,0,0),nzbg=elem.toDataURL(),32<nzbg.length&&(nbg.style.backgroundImage="url("+nzbg+")"),grw=2,grh=56,elem.width=grw,elem.height=grh,ctx=elem.getContext("2d"),map=ctx.getImageData(0,0,grw,grh),imgd=map.data,l=imgd.length,yy=p=0;grh>yy;yy++)for(j=(grh-1-yy)/(grh-1),j=.5*(1-Math.cos(Math.PI*j)),xx=0;grw>xx;xx++)imgd[p]=Math.min(255,Math.floor(54.4+32*j)),imgd[p+1]=Math.min(255,Math.floor(108.8+64*j)),imgd[p+2]=Math.min(255,Math.floor(81.6+48*j)),imgd[p+3]=255,p+=4;for(ctx.putImageData(map,0,0),sadg=elem.toDataURL(),elem=document.createElement("canvas"),elem.width=grw,elem.height=grh,ctx=elem.getContext("2d"),map=ctx.getImageData(0,0,grw,grh),imgd=map.data,l=imgd.length,yy=p=0;grh>yy;yy++)for(j=(grh-1-yy)/(grh-1),j=.5*(1-Math.cos(Math.PI*j)),xx=0;grw>xx;xx++)imgd[p]=Math.min(255,Math.floor(72+.95*48*j)),imgd[p+1]=Math.min(255,Math.floor(171+93.1*j)),imgd[p+2]=Math.min(255,Math.floor(132+.95*87*j)),imgd[p+3]=255,p+=4;for(ctx.putImageData(map,0,0),sadu=elem.toDataURL(),elem=document.createElement("canvas"),elem.width=grw,elem.height=grh,ctx=elem.getContext("2d"),map=ctx.getImageData(0,0,grw,grh),imgd=map.data,l=imgd.length,yy=p=0;grh>yy;yy++)for(j=yy/(grh-1),j=.5*(1-Math.cos(Math.PI*j)),xx=0;grw>xx;xx++)imgd[p]=Math.floor(.1*48+36*j),imgd[p+1]=Math.floor(7+52.5*j),imgd[p+2]=Math.floor(6.4+48*j),imgd[p+3]=255,p+=4;for(ctx.putImageData(map,0,0),sadd=elem.toDataURL(),32<sadg.length&&32<sadu.length&&32<sadd.length&&addCss(".sadg1 { background-image:url("+sadg+"); }  .sadu1 { background-image:url("+sadu+"); }  .sadd1 { background-image:url("+sadd+"); }"),elem.width=grw,elem.height=grh,ctx=elem.getContext("2d"),map=ctx.getImageData(0,0,grw,grh),imgd=map.data,l=imgd.length,yy=p=0;grh>yy;yy++)for(j=(grh-1-yy)/(grh-1),j=.5*(1-Math.cos(Math.PI*j)),xx=0;grw>xx;xx++)imgd[p]=Math.min(255,Math.floor(.85*52+26*j)),imgd[p+1]=Math.min(255,Math.floor(81.6+48*j)),imgd[p+2]=Math.min(255,Math.floor(.85*144+72*j)),imgd[p+3]=255,p+=4;for(ctx.putImageData(map,0,0),sadg=elem.toDataURL(),elem=document.createElement("canvas"),elem.width=grw,elem.height=grh,ctx=elem.getContext("2d"),map=ctx.getImageData(0,0,grw,grh),imgd=map.data,l=imgd.length,yy=p=0;grh>yy;yy++)for(j=(grh-1-yy)/(grh-1),j=.5*(1-Math.cos(Math.PI*j)),xx=0;grw>xx;xx++)imgd[p]=Math.min(255,Math.floor(72+.95*48*j)),imgd[p+1]=Math.min(255,Math.floor(132+.95*87*j)),imgd[p+2]=Math.min(255,Math.floor(171+93.1*j)),imgd[p+3]=255,p+=4;for(ctx.putImageData(map,0,0),sadu=elem.toDataURL(),elem=document.createElement("canvas"),elem.width=grw,elem.height=grh,ctx=elem.getContext("2d"),map=ctx.getImageData(0,0,grw,grh),imgd=map.data,l=imgd.length,yy=p=0;grh>yy;yy++)for(j=yy/(grh-1),j=.5*(1-Math.cos(Math.PI*j)),xx=0;grw>xx;xx++)imgd[p]=Math.floor(.1*48+36*j),imgd[p+1]=Math.floor(5.4+40.5*j),imgd[p+2]=Math.floor(7+52.5*j),imgd[p+3]=255,p+=4;ctx.putImageData(map,0,0),sadd=elem.toDataURL(),32<sadg.length&&32<sadu.length&&32<sadd.length&&addCss(".sadg2 { background-image:url("+sadg+"); }  .sadu2 { background-image:url("+sadu+"); }  .sadd2 { background-image:url("+sadd+"); }");var mos=[],m_iv=-1,swmup=!1,sos=[],clus=[],bso,u_m=[64,32,16,8,4,2,1],lgbsc=1,lgcsc=1,lb_fr=0,login_fr=0,llgmtm=Date.now(),login_iv=-1,ss_a=0,ss_sh=0,spinner_shown=!1,ldmc=document.createElement("canvas");ldmc.width=128,ldmc.height=128,ldmc.style.position="fixed",ldmc.style.left="0px",ldmc.style.top="0px",ldmc.style.zIndex=8388607,ldmc.style.display="none",document.body.appendChild(ldmc);var lsfr=0,lcldtm=Date.now(),sstr="Save";"FR"==country?sstr="Bien":"BR"==country&&(sstr="OK");var sko_btn=o=makeTextBtn(String.fromCharCode(160)+sstr+String.fromCharCode(160),47,20,34,1),skodiv=o.elem;skodiv.style.zIndex=53,skodiv.style.position="fixed",skodiv.style.left="300px",skodiv.style.top="300px",skodiv.style.display="none",skodiv.style.opacity=0,document.body.appendChild(skodiv),o.elem.onclick=function(){if(playing){try{localStorage.snakercv=snake.rcv}catch(t){}playing=connected=!1,dead_mtm=Date.now()-5e3}};var nick=document.getElementById("nick"),victory=document.getElementById("victory"),victory_bg=document.getElementById("victory_bg"),logo=document.getElementById("logo"),login=document.getElementById("login"),lastscore=document.getElementById("lastscore"),nick_holder=document.getElementById("nick_holder"),victory_holder=document.getElementById("victory_holder"),pstr="Play";"DE"==country?pstr="Spielen":"FR"==country?(pstr="Jouer",nick.placeholder="Surnom"):"BR"==country&&(pstr="Joga",nick.placeholder="Apelido");var play_btn=o=makeTextBtn(String.fromCharCode(160)+pstr+String.fromCharCode(160),47,20,34,1),pbdiv=o.elem;pbdiv.style.position="relative",pbdiv.style.display="inline-block",pbdiv.style.marginTop="20px",pbdiv.style.marginBottom="50px";var playh=document.getElementById("playh");playh.style.opacity=0,playh.appendChild(pbdiv);var tips=document.getElementById("tips"),tipss=["Eat to grow longer!","Don't run into other snakes!","When longer, hold the mouse for a speed boost!"];"DE"==country?tipss=["Esse um zu wachsen!","Klicke für mehr Geschwindigkeit!","Bewege dich nicht in andere Schlangen!"]:"FR"==country?tipss=["Mangez de croître!","Cliquez et vous courrez!","Ne laissez pas votre tête toucher d'autres serpents!"]:"BR"==country&&(tipss=["Coma para crescer!","Clique para correr!","Não deixe que sua cabeça para tocar outras cobras!"]);var tip_pos=-1,tip_fr=1.9;o.elem.onclick=function(){play_btn.disabled||-1!=dead_mtm||(play_btn_click_mtm=Date.now(),play_btn.setEnabled(!1),spinner_shown=nick.disabled=!0,ldmc.style.display="inline",connect())};var save_btn=o=makeTextBtn(String.fromCharCode(160)+"Save Message"+String.fromCharCode(160),47,20,34,2),sbdiv=o.elem;sbdiv.style.position="relative",sbdiv.style.display="inline-block",sbdiv.style.marginTop="30px",sbdiv.style.marginBottom="50px";var saveh=document.getElementById("saveh");saveh.appendChild(sbdiv),o.elem.onclick=function(){if(!save_btn.disabled){var t=asciize(victory.value);if(140<t.length&&(t=t.substr(0,140)),protocol_version>=5){var e=new Uint8Array(2+t.length);e[0]=255,e[1]=118;for(var s=0;s<t.length;s++)e[s+2]=t.charCodeAt(s)}else for(e=new Uint8Array(1+t.length),e[0]=118,s=0;s<t.length;s++)e[s+1]=t.charCodeAt(s);ws.send(e),save_btn.setEnabled(!1),victory.disabled=!0}};var wide=!1,mww=850,mhh=700,mwwp50=mww+50,mhhp50=mhh+50,mwwp150=mww+150,mhhp150=mhh+150,mww2=mww/2,mhh2=mhh/2,mc=document.createElement("canvas");mc.style.position="fixed",mc.style.left="0px",mc.style.top="0px",mc.style.zIndex=5,mc.width=mww,mc.height=mhh,mc.className="nsi",document.body.appendChild(mc),mc.style.display="none",mc.style.pointerEvents="none";var lbh=document.createElement("div");lbh.className="nsi",lbh.style.position="fixed",lbh.style.right="4px",lbh.style.top="4px",lbh.style.textAlign="center",lbh.style.width="255px",lbh.style.height="28px",lbh.style.color="#ffffff",lbh.style.fontFamily='Arial, "Helvetica Neue", Helvetica, sans-serif',lbh.style.fontSize="21px",lbh.style.fontWeight="bold",lbh.style.overflow="hidden",lbh.style.opacity=.5,lbh.style.zIndex=7,lbh.style.display="none",lbh.style.cursor="default";var lstr="Leaderboard";"DE"==country?lstr="Bestenliste":"FR"==country?lstr="Gagnants":"BR"==country&&(lstr="Líderes"),lbh.textContent=lstr,trf(lbh,agpu),document.body.appendChild(lbh);var lbs=document.createElement("div");lbs.className="nsi",lbs.style.position="fixed",lbs.style.textAlign="center",lbs.style.right="4px",lbs.style.top="32px",lbs.style.width="50px",lbs.style.height="800px",lbs.style.color="#ffffff",lbs.style.fontFamily='Arial, "Helvetica Neue", Helvetica, sans-serif',lbs.style.fontSize="12px",lbs.style.overflow="hidden",lbs.style.opacity=.7,lbs.style.zIndex=7,lbs.style.display="none",lbs.style.cursor="default",lbs.style.lineHeight="150%",trf(lbs,agpu),document.body.appendChild(lbs);var lbn=document.createElement("div");lbn.className="nsi",lbn.style.position="fixed",lbn.style.textAlign="left",lbn.style.whiteSpace="nowrap",lbn.style.right="64px",lbn.style.top="32px",lbn.style.width="150px",lbn.style.height="800px",lbn.style.color="#ffffff",lbn.style.fontFamily='Arial, "Helvetica Neue", Helvetica, sans-serif',lbn.style.fontSize="12px",lbn.style.overflow="hidden",lbn.style.opacity=.7,lbn.style.zIndex=8,lbn.style.display="none",lbn.style.cursor="default",lbn.style.lineHeight="150%",trf(lbn,agpu),document.body.appendChild(lbn);var lbp=document.createElement("div");lbp.className="nsi",lbp.style.position="fixed",lbp.style.textAlign="right",lbp.style.right="230px",lbp.style.top="32px",lbp.style.width="30px",lbp.style.height="800px",lbp.style.color="#ffffff",lbp.style.fontFamily='Arial, "Helvetica Neue", Helvetica, sans-serif',lbp.style.fontSize="12px",lbp.style.overflow="hidden",lbp.style.opacity=.7,lbp.style.zIndex=9,lbp.style.display="none",lbp.style.cursor="default",lbp.style.lineHeight="150%",trf(lbp,agpu),document.body.appendChild(lbp);var lbf=document.createElement("div");lbf.className="nsi",lbf.style.position="fixed",lbf.style.left="8px",lbf.style.bottom="4px",lbf.style.width="200px",lbf.style.height="37px",lbf.style.color="#ffffff",lbf.style.fontFamily='Arial, "Helvetica Neue", Helvetica, sans-serif',lbf.style.fontSize="12px",lbf.style.overflow="hidden",lbf.style.opacity=.5,lbf.style.zIndex=7,lbf.style.display="none",lbf.style.cursor="default",lbf.style.lineHeight="150%",trf(lbf,agpu),document.body.appendChild(lbf);var vcm=document.createElement("div");vcm.className="nsi",vcm.style.position="fixed",vcm.style.left="8px",vcm.style.top="4px",vcm.style.width="300px",vcm.style.height="228px",vcm.style.color="#ffffff",vcm.style.fontFamily='Arial, "Helvetica Neue", Helvetica, sans-serif',vcm.style.fontSize="13px",vcm.style.overflow="hidden",vcm.style.wordWrap="break-word",vcm.style.opacity=.5,vcm.style.zIndex=7,vcm.style.display="none",vcm.style.cursor="default",trf(vcm,agpu),document.body.appendChild(vcm);var loch=document.createElement("div");loch.className="nsi",loch.style.position="fixed",loch.style.right="16px",loch.style.bottom="16px",loch.style.width=loch.style.height="104px",loch.style.zIndex=10,loch.style.display="none",document.body.appendChild(loch);var loc=document.createElement("img"),lc=document.createElement("canvas");lc.width=lc.height=104,ctx=lc.getContext("2d"),ctx.save(),ctx.fillStyle="#485868",ctx.shadowBlur=12,ctx.shadowOffsetY=3,ctx.shadowColor="#000000",ctx.beginPath(),ctx.arc(52,52,40,0,pi2),ctx.fill(),ctx.restore(),ctx.fillStyle="#708090",ctx.beginPath(),ctx.moveTo(52,52),ctx.arc(52,52,40,0,Math.PI/2),ctx.lineTo(52,52),ctx.fill(),ctx.beginPath(),ctx.moveTo(52,52),ctx.arc(52,52,40,Math.PI,3*Math.PI/2),ctx.lineTo(52,52),ctx.fill(),ctx.strokeStyle="#202630",ctx.lineWidth=1,ctx.beginPath(),ctx.moveTo(52,12),ctx.lineTo(52,92),ctx.stroke(),ctx.beginPath(),ctx.moveTo(12,52),ctx.lineTo(92,52),ctx.stroke(),loc.src=lc.toDataURL(),loc.className="nsi",loc.style.position="absolute",loc.style.left="0px",loc.style.top="0px",loc.style.opacity=.45,loc.style.zIndex=11,trf(loc,agpu),loch.appendChild(loc);var asmc=document.createElement("canvas");asmc.width=80,asmc.height=80,asmc.className="nsi",asmc.style.position="absolute",asmc.style.left=asmc.style.top="12px",asmc.style.zIndex=12,asmc.style.opacity=.25,loch.appendChild(asmc);var myloc=document.createElement("img");lc.width=lc.height=14,ctx=lc.getContext("2d"),ctx.fillStyle="#DDDDDD",ctx.strokeStyle="#000000",ctx.lineWidth=2,ctx.beginPath(),ctx.arc(7,7,2.5,0,pi2),ctx.stroke(),ctx.fill(),myloc.src=lc.toDataURL(),myloc.className="nsi",myloc.style.position="absolute",myloc.style.left="0px",myloc.style.top="0px",myloc.style.opacity=1,myloc.style.zIndex=13,trf(myloc,agpu),loch.appendChild(myloc),ctx=mc.getContext("2d");var bgi2=document.createElement("canvas"),bgp2=null,bgw2=599,bgh2=519,ii=document.createElement("img");ii.onload=function(){bgi2.width=bgw2,bgi2.height=bgh2;var t=bgi2.getContext("2d");try{t.drawImage(this,0,0),bgp2=t.createPattern(bgi2,"repeat")}catch(e){}},ii.src="/s/bg45.jpg";var ggbg=!1,gbgmc=null,gbgi=document.createElement("img");gbgi.onload=function(){ggbg=!0,rdgbg()},gbgi.src="/s/gbg.jpg";var flt_a="ler did no;gas the;gas all;gas every;panis;panus;paynis;my ass;cut your;heil hit;flick your;fingerba;arse;naked;menstr;eat my;suck my;fuk;dong;cunn;penil;suck a;foresk;puto;puta;suck;mierd;bit.ly;slitherplus;ween;wein;peen".split(";"),flt_g="buttlov buttf smegm litherplu eatmy suckm sucka mydik urdik".split(" "),flt_w=["ass","kkk"],bpx1,bpy1,bpx2,bpy2,fpx1,fpy1,fpx2,fpy2,sgsc=.9,gsc=sgsc,nsep=4.5,tasty=0,shifty=!1,rr,gg,bb,render_mode=2;is_mobile&&(render_mode=1);var wumsts=!1,rank=0,best_rank=999999999,snake_count=0,biggest_snake_count=0,cm1,snakes=[],foods=[],foods_c=0,preys=[],points_dp=newDeadpool(),os={},lsang=0,want_e=!1,last_e_mtm=0,sectors=[],sector_size=480,sector_count_along_edge=130,spangdv=4.8,nsp1=4.25,nsp2=.5,nsp3=12,mamu=.033,mamu2=.028,cst=.43,lfas=[],lfc=128;for(i=0;lfc>i;i++)j=.5*(1-Math.cos(Math.PI*(lfc-1-i)/(lfc-1))),lfas.push(j);var rfas=[],rfc=43;for(i=0;rfc>i;i++)j=.5*(1-Math.cos(Math.PI*(rfc-1-i)/(rfc-1))),rfas.push(j);for(var fao={},fc=3;100>=fc;fc++){var fas=[];for(i=0;fc>i;i++)j=.5*(1-Math.cos(Math.PI*(fc-1-i)/(fc-1))),fas.push(j);fao["a"+fc]=fas}var hfc=92,hfas=new Float32Array(hfc);for(i=0;hfc>i;i++)j=.5*(1-Math.cos(Math.PI*(hfc-1-i)/(hfc-1))),hfas[i]=j;var afas=[],afc=26;for(i=0;afc>i;i++)j=.5*(1-Math.cos(Math.PI*(afc-1-i)/(afc-1))),afas.push(j);var nlc=48,vfas=[],vfc=62,fvpos=0,fvtg=0,ovxx,ovyy,fvxs=[],fvys=[];for(i=0;vfc>i;i++)j=.5*(1-Math.cos(Math.PI*(vfc-1-i)/(vfc-1))),j+=.5*(.5*(1-Math.cos(Math.PI*j))-j),vfas.push(j),fvxs.push(0),fvys.push(0);var p1a=pca(.1),p35a=pca(.35),pwr4=pwr(.4),pwr35=pwr(.35),pwr93=pwr(.93),kdmc=document.createElement("canvas");kdmc.width=kdmc.height=32,ctx=kdmc.getContext("2d"),ctx.fillStyle="#FF9966",ctx.arc(16,16,16,0,pi2),ctx.fill();var sz=52,komc=document.createElement("canvas");for(komc.width=komc.height=sz,ctx=komc.getContext("2d"),map=ctx.getImageData(0,0,sz,sz),imgd=map.data,l=imgd.length,p=yy=xx=0;l>p;p+=4){var v=Math.abs(Math.sqrt(Math.pow(sz/2-xx,2)+Math.pow(sz/2-yy,2))-16),v=4>=v?1-v/4:0,v=.8*v;imgd[p]=imgd[p+1]=imgd[p+2]=0,imgd[p+3]=Math.floor(255*v),xx++,xx>=sz&&(xx=0,yy++)}ctx.putImageData(map,0,0);var sz=62,ksmc=document.createElement("canvas");for(ksmc.width=ksmc.height=sz,ctx=ksmc.getContext("2d"),map=ctx.getImageData(0,0,sz,sz),imgd=map.data,l=imgd.length,p=yy=xx=0;l>p;p+=4)v=Math.sqrt(Math.pow(sz/2-xx,2)+Math.pow(sz/2+3-yy,2))-15,v*=.1,0>v&&(v=-v),v>1&&(v=1),v=1-v,v*=.25,imgd[p]=imgd[p+1]=imgd[p+2]=0,imgd[p+3]=Math.floor(255*v),xx++,xx>=sz&&(xx=0,yy++);ctx.putImageData(map,0,0);var rabulb=document.createElement("canvas");rabulb.width=rabulb.height=64,ctx=rabulb.getContext("2d");var g=ctx.createRadialGradient(32,32,1,32,32,31);g.addColorStop(0,"rgba(255, 255, 255, 1)"),g.addColorStop(.83,"rgba(150,150,150, 1)"),g.addColorStop(.84,"rgba(80,80,80, 1)"),g.addColorStop(.99,"rgba(80,80,80, 1)"),g.addColorStop(1,"rgba(80,80,80, 0)"),ctx.fillStyle=g,ctx.fillRect(0,0,64,64);var cdbulb=document.createElement("canvas");cdbulb.width=84,cdbulb.height=84;var cdbulb2=document.createElement("canvas");cdbulb2.width=84,cdbulb2.height=84,ctx=cdbulb2.getContext("2d"),ctx.fillStyle="#ff5609",ctx.fillRect(13,10,29,64),ctx.fillRect(13,10,58,22),ctx.fillRect(13,54,58,22),ctx=cdbulb.getContext("2d"),ctx.shadowColor="#000000",ctx.shadowBlur=20,ctx.drawImage(cdbulb2,0,0),ctx.drawImage(cdbulb2,0,0);var acbulb=document.createElement("canvas");acbulb.width=acbulb.height=64,ctx=acbulb.getContext("2d"),g=ctx.createRadialGradient(32,32,1,32,32,31),g.addColorStop(0,"rgba(255, 128, 128, 1)"),g.addColorStop(.5,"rgba(222, 3, 3, 1)"),g.addColorStop(.96,"rgba(157, 18, 18, 1)"),g.addColorStop(1,"rgba(0,0,0, 0)"),ctx.fillStyle=g,ctx.fillRect(0,0,64,64);var colc;testing&&(colc=document.createElement("canvas"),colc.width=256,colc.height=66,colc.style.position="fixed",colc.style.left="0px",colc.style.top="200px",colc.style.zIndex=2147483647,document.body.appendChild(colc));var pbx=new Float32Array(32767),pby=new Float32Array(32767),pba=new Float32Array(32767),pbu=new Uint8Array(32767),per_color_imgs=[],rrs=[192,144,128,128,238,255,255,255,224,255,144,80,255,40,100,120,72,160,255,56,56,62,255,101],ggs=[128,153,208,255,238,160,144,64,48,255,153,80,192,136,117,134,84,80,224,68,68,19,86,200],bbs=[255,255,208,128,112,96,144,64,224,255,255,80,80,96,255,255,255,255,64,255,255,160,9,232],max_skin_cv=25;for(i=0;i<rrs.length;i++){o={imgs:[],fws:[],fhs:[],fw2s:[],fh2s:[],gimgs:[],gfws:[],gfhs:[],gfw2s:[],gfh2s:[],oimgs:[],ofws:[],ofhs:[],ofw2s:[],ofh2s:[]};var rs="00"+rrs[i].toString(16),gs="00"+ggs[i].toString(16),bs="00"+bbs[i].toString(16),rs=rs.substr(rs.length-2),gs=gs.substr(gs.length-2),bs=bs.substr(bs.length-2);o.cs="#"+rs+gs+bs;var sz=62,kfmc=document.createElement("canvas");for(kfmc.width=kfmc.height=sz,ctx=kfmc.getContext("2d"),map=ctx.getImageData(0,0,sz,sz),imgd=map.data,l=imgd.length,p=yy=xx=0;l>p;p+=4)v=Math.abs(Math.sqrt(Math.pow(sz/2-xx,2)+Math.pow(sz/2-yy,2))-16),v=15>=v?1-v/15:0,imgd[p]=rrs[i],imgd[p+1]=ggs[i],imgd[p+2]=bbs[i],imgd[p+3]=Math.floor(255*v),xx++,xx>=sz&&(xx=0,yy++);ctx.putImageData(map,0,0),o.kfmc=kfmc;var ksz=48,ksz2=ksz/2,kmc=document.createElement("canvas");kmc.width=kmc.height=ksz,ctx=kmc.getContext("2d"),ctx.fillStyle="#FFFFFF",ctx.arc(ksz2,ksz2,ksz2,0,pi2),ctx.fill(),map=ctx.getImageData(0,0,ksz,ksz),imgd=map.data,l=imgd.length,yy=xx=0;var kmcs=[];for(j=0;7>j;j++){for(p=xx=yy=0;l>p;p+=4){var v=Math.pow(Math.max(0,Math.min(1,1-Math.abs(yy-ksz2)/ksz2)),.35),v2=Math.max(0,Math.min(1,1-Math.sqrt(Math.pow(xx-ksz2,2)+Math.pow(yy-ksz2,2))/34)),v=v+.375*(v2-v),v=v*(1.22-.44*j/6);rr=rrs[i],gg=ggs[i],bb=bbs[i],imgd[p]=Math.max(0,Math.min(255,Math.floor(rr*v))),imgd[p+1]=Math.max(0,Math.min(255,Math.floor(gg*v))),imgd[p+2]=Math.max(0,Math.min(255,Math.floor(bb*v))),xx++,xx>=ksz&&(xx=0,yy++)}ctx.putImageData(map,0,0);var kmc2=document.createElement("canvas");kmc2.width=kmc2.height=ksz;var ctx2=kmc2.getContext("2d");if(ctx2.drawImage(kmc,0,0),10==i)for(k=-1;1>=k;k++){var tx=ksz2+ksz2/16*Math.cos(2*Math.PI*k/8)*13,ty=ksz2+ksz2/16*Math.sin(2*Math.PI*k/8)*13;for(ctx2.fillStyle="#FFFFFF",ctx2.beginPath(),m=0;5>=m;m++)xx=tx+ksz/32*Math.cos(2*Math.PI*m/5)*.05*24,yy=ty+ksz/32*Math.sin(2*Math.PI*m/5)*.05*24,0==m?ctx2.moveTo(xx,yy):ctx2.lineTo(xx,yy),xx=tx+ksz/32*Math.cos(2*Math.PI*(m+.5)/5)*3.1,yy=ty+ksz/32*Math.sin(2*Math.PI*(m+.5)/5)*3.1,ctx2.lineTo(xx,yy);ctx2.fill()}else if(19==i)for(k=-2;2>=k;k++){for(tx=ksz2+ksz2/16*Math.cos(2*Math.PI*k/15)*13,ty=ksz2+ksz2/16*Math.sin(2*Math.PI*k/15)*13,ctx2.save(),ctx2.globalAlpha=.7,ctx2.fillStyle="#FFFFFF",ctx2.beginPath(),m=0;5>=m;m++)xx=tx+ksz/32*Math.cos(2*Math.PI*m/5)*.05*12,yy=ty+ksz/32*Math.sin(2*Math.PI*m/5)*.05*12,0==m?ctx2.moveTo(xx,yy):ctx2.lineTo(xx,yy),xx=tx+ksz/32*Math.cos(2*Math.PI*(m+.5)/5)*1.55,yy=ty+ksz/32*Math.sin(2*Math.PI*(m+.5)/5)*1.55,ctx2.lineTo(xx,yy);ctx2.fill(),ctx2.restore()}else if(20==i)for(k=-1.5;1.5>=k;k++){for(tx=ksz2+ksz2/16*Math.cos(2*Math.PI*k/15)*13,ty=ksz2+ksz2/16*Math.sin(2*Math.PI*k/15)*13,ctx2.save(),ctx2.globalAlpha=.7,ctx2.fillStyle="#FFFFFF",ctx2.beginPath(),m=0;5>=m;m++)xx=tx+ksz2/16*Math.cos(2*Math.PI*m/5)*.05*14,yy=ty+ksz2/16*Math.sin(2*Math.PI*m/5)*.05*14,0==m?ctx2.moveTo(xx,yy):ctx2.lineTo(xx,yy),xx=tx+ksz2/16*Math.cos(2*Math.PI*(m+.5)/5)*1.8,yy=ty+ksz2/16*Math.sin(2*Math.PI*(m+.5)/5)*1.8,ctx2.lineTo(xx,yy);ctx2.fill(),ctx2.restore()}kmcs.push(kmc2)}for(o.kmcs=kmcs,per_color_imgs.push(o),j=2.8;18.8>=j;j+=1){var cc=document.createElement("canvas"),sz=Math.ceil(2.5*j+28);cc.width=cc.height=sz,ctx=cc.getContext("2d"),ctx.fillStyle=o.cs,ctx.arc(sz/2,sz/2,.65*j,0,pi2),ctx.shadowBlur=12,ctx.shadowOffsetY=0,ctx.shadowColor="#"+rs+gs+bs,ctx.globalAlpha=.8,ctx.fill(),ctx.globalAlpha=1,ctx.fill(),o.imgs.push(cc),o.fws.push(sz),o.fhs.push(sz),o.fw2s.push(sz/2),o.fh2s.push(sz/2),sz=Math.ceil(8*j+6),cc=document.createElement("canvas"),cc.width=cc.height=sz,ctx=cc.getContext("2d"),g=ctx.createRadialGradient(sz/2,sz/2,1,sz/2,sz/2,4*j),g.addColorStop(0,"rgba("+rrs[i]+", "+ggs[i]+", "+bbs[i]+", 1)"),g.addColorStop(1,"rgba("+rrs[i]+", "+ggs[i]+", "+bbs[i]+", 0)"),ctx.fillStyle=g,ctx.fillRect(0,0,sz,sz),o.gimgs.push(cc),o.gfws.push(sz),o.gfhs.push(sz),o.gfw2s.push(sz/2),o.gfh2s.push(sz/2),cc=document.createElement("canvas"),sz=Math.ceil(1.3*j+6),cc.width=cc.height=sz,ctx=cc.getContext("2d");var eam=.2,g=ctx.createRadialGradient(sz/2,sz/2,0,sz/2,sz/2,j/2);g.addColorStop(0,"rgba("+rrs[i]+", "+ggs[i]+", "+bbs[i]+", 1)"),g.addColorStop(.99,"rgba("+Math.floor(rrs[i]*eam)+", "+Math.floor(ggs[i]*eam)+", "+Math.floor(bbs[i]*eam)+", 1)"),g.addColorStop(1,"rgba("+Math.floor(rrs[i]*eam)+", "+Math.floor(ggs[i]*eam)+", "+Math.floor(bbs[i]*eam)+", 0)"),ctx.fillStyle=g,ctx.fillRect(0,0,sz,sz),ctx.strokeStyle="#000000",ctx.lineWidth=2,ctx.arc(sz/2,sz/2,.65*j,0,pi2),ctx.globalAlpha=1,ctx.stroke(),o.oimgs.push(cc),o.ofws.push(sz),o.ofhs.push(sz),o.ofw2s.push(sz/2),o.ofh2s.push(sz/2)}for(o.ic=o.imgs.length,o.pr_imgs=[],o.pr_fws=[],o.pr_fhs=[],o.pr_fw2s=[],o.pr_fh2s=[],j=3;24>=j;j+=1)cc=document.createElement("canvas"),sz=Math.ceil(2*j+38),cc.width=cc.height=sz,ctx=cc.getContext("2d"),ctx.fillStyle=o.cs,ctx.arc(sz/2,sz/2,j/2,0,pi2),ctx.shadowBlur=22,ctx.shadowOffsetY=0,ctx.shadowColor="#"+rs+gs+bs,ctx.fill(),ctx.fill(),o.pr_imgs.push(cc),o.pr_fws.push(sz),o.pr_fhs.push(sz),o.pr_fw2s.push(sz/2),o.pr_fh2s.push(sz/2)}if(testing)for(ctx=colc.getContext("2d"),ctx.fillStyle="#000000",ctx.fillRect(0,0,colc.width,colc.height),ctx.fillStyle="#FFFFFF",ctx.font="10px Arial, Helvetica Neue, Helvetica, sans-serif",ctx.textBaseline="top",ctx.textAlign="center",i=yy=xx=0;i<rrs.length;i++){var pci=per_color_imgs[i],kmc=pci.kmcs[0];ctx.drawImage(kmc,0,0,kmc.width,kmc.height,xx,yy,16,16),ntx=o.xx+o.fx,nty=o.yy+o.fy,ntx=mww2+(ntx-view_xx)*gsc,nty=mhh2+(nty-view_yy)*gsc,ctx.fillText(""+i,xx+8,yy+16),xx+=16,xx>colc.width-16&&(xx=0,yy+=28)}var view_xx=0,view_yy=0,view_ang=0,view_dist=0,fvx=0,fvy=0,xm=0,ym=0,lsxm=0,lsym=0,snake=null,my_nick="",dhx,dhy,hsz,fr=0,lfr=0,ltm=Date.now(),vfr=0,vfrb=0,avfr=0,fr2=0,lfr2=0,vfrb2=0,cptm=0,lptm=0,lpstm=0,last_ping_mtm=0,lagging=!1,lag_mult=1,wfpr=!1,high_quality=!0,gla=1,wdfg=0,qsm=1,mqsm=1.7,playing=!1,connected=!1,want_close_socket=!1,want_victory_message=!1,want_victory_focus=!1,want_hide_victory=0,hvfr=0,dead_mtm=-1,at2lt=new Float32Array(65536);for(yy=0;256>yy;yy++)for(xx=0;256>xx;xx++)at2lt[yy<<8|xx]=Math.atan2(yy-128,xx-128);var kd_l_frb=0,kd_r_frb=0,kd_l=!1,kd_r=!1,kd_u=!1,lkstm=0,social=document.createElement("iframe");try{social.frameBorder=0}catch(b){}social.style.position="fixed",social.style.left="6px",social.style.top="6px",social.style.border="0px",social.style.zIndex=9999999,social.width=200,social.height=150,social.src="/social-box/",document.body.appendChild(social);var oef=function(){var t=Date.now();if(avfr=vfr=(t-ltm)/8,ltm=t,choosing_skin||(lagging||wfpr&&t-last_ping_mtm>420&&(lagging=!0),lagging?(lag_mult*=.85,.01>lag_mult&&(lag_mult=.01)):1>lag_mult&&(lag_mult+=.05,lag_mult>=1&&(lag_mult=1))),vfr>120&&(vfr=120),vfr*=lag_mult,etm*=lag_mult,lfr=fr,fr+=vfr,vfrb=Math.floor(fr)-Math.floor(lfr),lfr2=fr2,fr2+=2*vfr,vfrb2=Math.floor(fr2)-Math.floor(lfr2),kd_l&&(kd_l_frb+=vfrb),kd_r&&(kd_r_frb+=vfrb),spinner_shown){lsfr+=avfr;var e=ldmc.getContext("2d");e.clearRect(0,0,512,128);for(var s,a,l=1;2>=l;l++){e.beginPath(),1==l?(e.fillStyle="#60FF70",a=0):(e.fillStyle="#9850FF",a=Math.PI);for(var o=0;256>=o;o++)s=32+5*Math.cos(a+lsfr/6+8*o/256)+8*o/256,256==o&&(s+=10),xx=64+Math.cos(a+lsfr/44+.8*Math.PI*o/256)*s*1.25,yy=64+Math.sin(a+lsfr/44+.8*Math.PI*o/256)*s,0==o?e.moveTo(xx,yy):e.lineTo(xx,yy);for(s=32,xx=64+Math.cos(a+lsfr/44+.8*Math.PI*(o+47)/256)*s*1.25,yy=64+Math.sin(a+lsfr/44+.8*Math.PI*(o+47)/256)*s,e.lineTo(xx,yy),o=256;o>=0;o--)s=32+5*Math.cos(a+lsfr/6+8*o/256)-8*o/256,256==o&&(s-=10),xx=64+Math.cos(a+lsfr/44+.8*Math.PI*o/256)*s*1.25,yy=64+Math.sin(a+lsfr/44+.8*Math.PI*o/256)*s,e.lineTo(xx,yy);e.fill()}connecting?(ss_a+=avfr/86,ss_a>=1&&(ss_a=1),ss_sh+=avfr/93,ss_sh>=1&&(ss_sh=1)):(ss_a-=avfr/86,0>=ss_a&&(ss_sh=ss_a=0,ldmc.style.display="none",trf(ldmc,""))),ldmc.style.opacity=ss_a,o=Math.round(.1+.9*ss_sh*(1+2*Math.pow(1-ss_a,2))*1e5)/1e5,trf(ldmc,"scale("+o+","+o+")")}if(-1!=play_btn_click_mtm&&t-play_btn_click_mtm>6666){if(o=document.createElement("img"),a=[],a.push("bso="+encodeURIComponent(bso)),bso)for(var i in bso)a.push(i+"="+encodeURIComponent(bso[i]));a.push("waiting_for_sos="+(waiting_for_sos?"true":"false")),a.push("soslen="+sos.length),o.src="http://slither.io/cnc.jpg?"+a.join("&"),play_btn_click_mtm=-1}if(waiting_for_sos&&t>sos_ready_after_mtm&&(connecting||connected||connect()),connecting&&t-start_connect_mtm>3e3&&(bso&&(bso.tainted=!0),connect()),choosing_skin){for(o=snakes.length-1;o>=0;o--)for(i=snakes[o],l=i.pts.length-1;l>=0;l--)i.pts[l].yy=grd/2+15*Math.cos(l/4+fr/19)*(1-l/i.pts.length);view_xx-=vfr}if(playing&&(high_quality?(1>gla&&(gla+=.0075*vfr,gla>1&&(gla=1)),qsm>1&&(qsm-=4e-5*vfr,1>qsm&&(qsm=1))):(gla>0&&(gla-=.0075*vfr,0>gla&&(gla=0)),mqsm>qsm&&(qsm+=4e-5*vfr,qsm>mqsm&&(qsm=mqsm)))),0!=want_hide_victory&&(1==want_hide_victory?(hvfr+=.02*vfr,hvfr>=1?(hvfr=0,want_hide_victory=2,victory_holder.style.opacity=1,saveh.style.opacity=1,victory_holder.style.display="none",saveh.style.display="none",nick_holder.style.opacity=0,playh.style.opacity=0,smh.style.opacity=0,nick_holder.style.display="inline-block",playh.style.display="block",smh.style.display="block"):(victory_holder.style.opacity=1-hvfr,saveh.style.opacity=1-hvfr)):2==want_hide_victory&&(hvfr+=.02*vfr,hvfr>=1&&(hvfr=1,want_hide_victory=0),nick_holder.style.opacity=hvfr,playh.style.opacity=hvfr,smh.style.opacity=hvfr)),1!=login_fr&&-1!=tip_fr&&(tip_fr+=.017*vfr,tip_fr>=pi2&&(tip_fr-=pi2,tip_pos++,tip_pos>=tipss.length&&(tip_pos=0),tips.textContent=tipss[tip_pos]),l=.5-.5*Math.cos(tip_fr),tips.style.opacity=Math.round(1e5*Math.pow(l,.5))/1e5),-1==dead_mtm)-1!=lb_fr&&1!=lb_fr&&(lb_fr+=.01*vfr,lb_fr>=1&&(lb_fr=1),lbh.style.opacity=.85*lb_fr,lbs.style.opacity=lbn.style.opacity=lbp.style.opacity=lbf.style.opacity=vcm.style.opacity=lb_fr);else if(t-dead_mtm>1600){if(-1==login_iv){login_iv=-2,login.style.display="inline";try{"1"!=localStorage.edttsg?cstx.style.display="inline":cskh.style.display="inline"}catch(n){}fbh.style.display="inline",twth.style.display="inline",plq.style.display="inline",clq.style.display="inline",grqh.style.display="inline",social.style.display="inline",want_victory_focus&&(want_victory_focus=!1,victory.focus())}-2==login_iv&&(login_fr-=.004*vfr,choosing_skin&&(login_fr-=.007*vfr),lb_fr=login_fr,0>=login_fr&&(login_fr=0,dead_mtm=-1,nick.disabled=!1,nick.focus(),lb_fr=-1,playing=!1,choosing_skin&&(choosing_skin=!1,resetGame(),pskh.style.display="none",nskh.style.display="none",skodiv.style.display="none")),pbdiv.style.opacity=1-.5*Math.max(0,Math.min(1,6*login_fr)),lgcsc=1+.1*Math.pow(login_fr,2),
o=Math.round(lgbsc*lgcsc*1e5)/1e5,1==o?trf(login,""):trf(login,"scale("+o+","+o+")"),login.style.opacity=1-login_fr,cstx.style.opacity=1-login_fr,fbh.style.opacity=1-login_fr,twth.style.opacity=1-login_fr,cskh.style.opacity=1-login_fr,grqh.style.opacity=1-login_fr,plq.style.opacity=1-login_fr,clq.style.opacity=1-login_fr,social.style.opacity=1-login_fr,pskh.style.opacity=login_fr,nskh.style.opacity=login_fr,skodiv.style.opacity=login_fr,mc.style.opacity=login_fr,loch.style.opacity=login_fr,lbh.style.opacity=.85*lb_fr,lbs.style.opacity=lbn.style.opacity=lbp.style.opacity=lbf.style.opacity=vcm.style.opacity=lb_fr)}if(want_close_socket&&-1==dead_mtm&&(want_close_socket=!1,ws&&(ws.close(),ws=null,playing=connected=!1),resetGame()),want_victory_message&&(victory_bg.style.opacity=.92+.08*Math.cos(fr/10)),connected&&((kd_l_frb>0||kd_r_frb>0)&&t-lkstm>150&&(lkstm=t,kd_r_frb>0&&kd_l_frb>kd_r_frb&&(kd_l_frb-=kd_r_frb,kd_r_frb=0),kd_l_frb>0&&kd_r_frb>kd_l_frb&&(kd_r_frb-=kd_l_frb,kd_l_frb=0),kd_l_frb>0?(v=kd_l_frb,v>127&&(v=127),kd_l_frb-=v,protocol_version>=5?(o=new Uint8Array(2),o[0]=252):(o=new Uint8Array(2),o[0]=108),o[1]=v,ws.send(o),snake.eang-=mamu*v*snake.scang*snake.spang):kd_r_frb>0&&(v=kd_r_frb,v>127&&(v=127),kd_r_frb-=v,protocol_version>=5?(v+=128,o=new Uint8Array(2),o[0]=252):(o=new Uint8Array(2),o[0]=114),o[1]=v,snake.eang+=mamu*v*snake.scang*snake.spang,ws.send(o))),!wfpr&&t-last_ping_mtm>250&&(last_ping_mtm=t,wfpr=!0,o=new Uint8Array(1),o[0]=protocol_version>=5?251:112,ws.send(o),lpstm=t)),null!=snake&&2147483647!=grd&&t-locu_mtm>1e3&&(locu_mtm=Date.now(),myloc.style.left=Math.round(52+40*(snake.xx-grd)/grd-7)+"px",myloc.style.top=Math.round(52+40*(snake.yy-grd)/grd-7)+"px"),t-lrd_mtm>1e3){if(testing&&console&&console.log){for(console.log("FPS: "+fps),a=[],trdps+=rdps,playing&&tcsecs++,a.push("FPS: "+fps),a.push("sectors: "+sectors.length),a.push("foods: "+foods_c),a.push("bytes/sec: "+rdps),a.push("bytes/sec avg: "+Math.round(trdps/tcsecs)),a.push(""),o=i=0;o<rdpspc.length;o++)0<=rdpspc[o]&&(i+=rdpspc[o]);for(o=0;o<rdpspc.length;o++)0<=rdpspc[o]&&a.push(String.fromCharCode(o)+": "+rdpspc[o]+" ("+Math.round(rdpspc[o]/i*1e3)/10+"%)");for(a.push("total: "+i),maxp=pf_ep=pf_nap=pf_remove=pf_new_add=pf_add=0,a.push(""),o=1;o<pfs.length;o++)0!=pfs[o]&&(a.push(o+": "+Math.round(1e3*pfs[o])/1e3),pfs[o]=0);pft=0,pfd.innerHTML=a.join("<br>")}playing&&1==want_quality&&(32>=fps?high_quality&&(wdfg++,wdfg>=1&&(high_quality=!1)):(high_quality||fps>=48)&&wdfg>0&&(wdfg--,0>=wdfg&&(high_quality=!0))),wangnuc=angnuc=anguc=fps=reps=rsps=rnps=rfps=rdps=0,lrd_mtm=Date.now()}if(etm*=Math.pow(.993,vfrb),null!=snake&&((xm!=lsxm||ym!=lsym)&&(want_e=!0),want_e&&t-last_e_mtm>100&&(want_e=!1,last_e_mtm=t,lsxm=xm,lsym=ym,d2=xm*xm+ym*ym,d2>256?(ang=Math.atan2(ym,xm),snake.eang=ang):ang=snake.wang,ang%=pi2,0>ang&&(ang+=pi2),protocol_version>=5?(sang=Math.floor(251*ang/pi2),sang!=lsang&&(lsang=sang,o=new Uint8Array(1),o[0]=255&sang,lpstm=t,ws.send(o.buffer))):(sang=Math.floor(16777215*ang/pi2),sang!=lsang&&(lsang=sang,o=new Uint8Array(4),o[0]=101,o[1]=sang>>16&255,o[2]=sang>>8&255,o[3]=255&sang,lpstm=t,ws.send(o.buffer))))),!choosing_skin)for(o=snakes.length-1;o>=0;o--){if(i=snakes[o],e=mamu*vfr*i.scang*i.spang,t=i.sp*vfr/4,t>i.msl&&(t=i.msl),!i.dead){if(i.tsp!=i.sp&&(i.tsp<i.sp?(i.tsp+=.3*vfr,i.tsp>i.sp&&(i.tsp=i.sp)):(i.tsp-=.3*vfr,i.tsp<i.sp&&(i.tsp=i.sp))),i.tsp>i.fsp&&(i.sfr+=(i.tsp-i.fsp)*vfr*.021),0<i.fltg)for(a=vfrb,a>i.fltg&&(a=i.fltg),i.fltg-=a,qq=0;a>qq;qq++)i.fl=i.fls[i.flpos],i.fls[i.flpos]=0,i.flpos++,i.flpos>=lfc&&(i.flpos=0);else 0==i.fltg&&(i.fltg=-1,i.fl=0);i.cfl=i.tl+i.fl}if(1==i.dir?(i.ang-=e,(0>i.ang||i.ang>=pi2)&&(i.ang%=pi2),0>i.ang&&(i.ang+=pi2),a=(i.wang-i.ang)%pi2,0>a&&(a+=pi2),a>Math.PI&&(a-=pi2),a>0&&(i.ang=i.wang,i.dir=0)):2==i.dir?(i.ang+=e,(0>i.ang||i.ang>=pi2)&&(i.ang%=pi2),0>i.ang&&(i.ang+=pi2),a=(i.wang-i.ang)%pi2,0>a&&(a+=pi2),a>Math.PI&&(a-=pi2),0>a&&(i.ang=i.wang,i.dir=0)):i.ang=i.wang,1!=i.ehl&&(i.ehl+=.03*vfr,1<=i.ehl&&(i.ehl=1)),e=i.pts[i.pts.length-1],i.wehang=Math.atan2(i.yy+i.fy-e.yy-e.fy+e.eby*(1-i.ehl),i.xx+i.fx-e.xx-e.fx+e.ebx*(1-i.ehl)),i.dead||i.ehang==i.wehang||(a=(i.wehang-i.ehang)%pi2,0>a&&(a+=pi2),a>Math.PI&&(a-=pi2),0>a?i.edir=1:a>0&&(i.edir=2)),1==i.edir?(i.ehang-=.1*vfr,(0>i.ehang||i.ehang>=pi2)&&(i.ehang%=pi2),0>i.ehang&&(i.ehang+=pi2),a=(i.wehang-i.ehang)%pi2,0>a&&(a+=pi2),a>Math.PI&&(a-=pi2),a>0&&(i.ehang=i.wehang,i.edir=0)):2==i.edir&&(i.ehang+=.1*vfr,(0>i.ehang||i.ehang>=pi2)&&(i.ehang%=pi2),0>i.ehang&&(i.ehang+=pi2),a=(i.wehang-i.ehang)%pi2,0>a&&(a+=pi2),a>Math.PI&&(a-=pi2),0>a&&(i.ehang=i.wehang,i.edir=0)),i.dead||(i.xx+=Math.cos(i.ang)*t,i.yy+=Math.sin(i.ang)*t,i.chl+=t/i.msl),vfrb>0){for(l=i.pts.length-1;l>=0;l--)e=i.pts[l],e.dying&&(e.da+=.0015*vfrb,1<e.da&&(i.pts.splice(l,1),e.dying=!1,points_dp.add(e)));for(l=i.pts.length-1;l>=0;l--)if(e=i.pts[l],0<e.eiu){for(fy=fx=0,qq=cm1=e.eiu-1;qq>=0;qq--)e.efs[qq]=2==e.ems[qq]?e.efs[qq]+vfrb2:e.efs[qq]+vfrb,a=e.efs[qq],a>=hfc?(qq!=cm1&&(e.exs[qq]=e.exs[cm1],e.eys[qq]=e.eys[cm1],e.efs[qq]=e.efs[cm1],e.ems[qq]=e.ems[cm1]),e.eiu--,cm1--):(fx+=e.exs[qq]*hfas[a],fy+=e.eys[qq]*hfas[a]);e.fx=fx,e.fy=fy}}if(t=2.3*Math.cos(i.eang),a=2.3*Math.sin(i.eang),i.rex<t&&(i.rex+=vfr/6,i.rex>=t&&(i.rex=t)),i.rey<a&&(i.rey+=vfr/6,i.rey>=a&&(i.rey=a)),i.rex>t&&(i.rex-=vfr/6,i.rex<=t&&(i.rex=t)),i.rey>a&&(i.rey-=vfr/6,i.rey<=a&&(i.rey=a)),vfrb>0){if(0<i.ftg)for(a=vfrb,a>i.ftg&&(a=i.ftg),i.ftg-=a,qq=0;a>qq;qq++)i.fx=i.fxs[i.fpos],i.fy=i.fys[i.fpos],i.fchl=i.fchls[i.fpos],i.fxs[i.fpos]=0,i.fys[i.fpos]=0,i.fchls[i.fpos]=0,i.fpos++,i.fpos>=rfc&&(i.fpos=0);else 0==i.ftg&&(i.ftg=-1,i.fx=0,i.fy=0,i.fchl=0);if(0<i.fatg)for(a=vfrb,a>i.fatg&&(a=i.fatg),i.fatg-=a,qq=0;a>qq;qq++)i.fa=i.fas[i.fapos],i.fas[i.fapos]=0,i.fapos++,i.fapos>=afc&&(i.fapos=0);else 0==i.fatg&&(i.fatg=-1,i.fa=0)}i.dead?(i.dead_amt+=.02*vfr,1<=i.dead_amt&&snakes.splice(o,1)):1!=i.alive_amt&&(i.alive_amt+=.015*vfr,1<=i.alive_amt&&(i.alive_amt=1))}for(o=preys.length-1;o>=0;o--){if(l=preys[o],e=mamu2*vfr,t=l.sp*vfr/4,vfrb>0)if(0<l.ftg)for(a=vfrb,a>l.ftg&&(a=l.ftg),l.ftg-=a,qq=1;a>=qq;qq++)qq==a&&(l.fx=l.fxs[l.fpos],l.fy=l.fys[l.fpos]),l.fxs[l.fpos]=0,l.fys[l.fpos]=0,l.fpos++,l.fpos>=rfc&&(l.fpos=0);else 0==l.ftg&&(l.fx=0,l.fy=0,l.ftg=-1);1==l.dir?(l.ang-=e,(0>l.ang||l.ang>=pi2)&&(l.ang%=pi2),0>l.ang&&(l.ang+=pi2),a=(l.wang-l.ang)%pi2,0>a&&(a+=pi2),a>Math.PI&&(a-=pi2),a>0&&(l.ang=l.wang,l.dir=0)):2==l.dir?(l.ang+=e,(0>l.ang||l.ang>=pi2)&&(l.ang%=pi2),0>l.ang&&(l.ang+=pi2),a=(l.wang-l.ang)%pi2,0>a&&(a+=pi2),a>Math.PI&&(a-=pi2),0>a&&(l.ang=l.wang,l.dir=0)):l.ang=l.wang,l.xx+=Math.cos(l.ang)*t,l.yy+=Math.sin(l.ang)*t,l.gfr+=vfr*l.gr,l.eaten?(1.5!=l.fr&&(l.fr+=vfr/150,1.5<=l.fr&&(l.fr=1.5)),l.eaten_fr+=vfr/47,l.gfr+=vfr,i=l.eaten_by,1<=l.eaten_fr||!i?preys.splice(o,1):(l.eaten_fr4=Math.pow(l.eaten_fr,4),l.rad=1-Math.pow(l.eaten_fr,3))):1!=l.fr&&(l.fr+=vfr/150,1<=l.fr?(l.fr=1,l.rad=1):(l.rad=.5*(1-Math.cos(Math.PI*l.fr)),l.rad+=.66*(.5*(1-Math.cos(Math.PI*l.rad))-l.rad)))}for(o=cm1=foods_c-1;o>=0;o--)t=foods[o],t.gfr+=vfr*t.gr,t.eaten?(1.5!=t.fr&&(t.fr+=vfr/150,1.5<=t.fr&&(t.fr=1.5)),t.eaten_fr+=vfr/41,t.rad=1-Math.pow(t.eaten_fr,3),i=t.eaten_by,1<=t.eaten_fr||!i?(o==cm1?foods[o]=null:(foods[o]=foods[cm1],foods[cm1]=null),foods_c--,cm1--):(i=t.eaten_by,a=t.eaten_fr*t.eaten_fr,t.eaten_fr4=a*a,t.rad=1-t.eaten_fr*a,t.rx=t.xx+(i.xx+i.fx+Math.cos(i.ang+i.fa)*(43-24*a)*(1-a)-t.xx)*a,t.ry=t.yy+(i.yy+i.fy+Math.sin(i.ang+i.fa)*(43-24*a)*(1-a)-t.yy)*a,t.rx+=6*Math.cos(t.wsp*t.gfr)*(1-t.eaten_fr),t.ry+=6*Math.sin(t.wsp*t.gfr)*(1-t.eaten_fr))):(1!=t.fr&&(t.fr+=t.rsp*vfr/150,1<=t.fr?(t.fr=1,t.rad=1):(t.rad=.5*(1-Math.cos(Math.PI*t.fr)),t.rad+=.66*(.5*(1-Math.cos(Math.PI*t.rad))-t.rad))),t.rx=t.xx,t.ry=t.yy,t.rx=t.xx+6*Math.cos(t.wsp*t.gfr),t.ry=t.yy+6*Math.sin(t.wsp*t.gfr));vfrb=vfr=0,redraw(),no_raf||raf(oef)},bgx=0,bgy=0,bgx2=0,bgy2=0,fgfr=0,px,py,lpx,lpy,ax,ay,lax,lay,pax,pay,fx,fy,fs,maxp=0,fps=0,redraw=function(){fps++;var t=mc.getContext("2d");if(animating){if(snake){var e=.5+.4/Math.max(1,(snake.sct+16)/36);gsc!=e&&(e>gsc?(gsc+=2e-4,gsc>=e&&(gsc=e)):(gsc-=2e-4,e>=gsc&&(gsc=e)))}var e=view_xx,s=view_yy;if(null!=snake&&(fvtg>0&&(fvtg--,fvx=fvxs[fvpos],fvy=fvys[fvpos],fvxs[fvpos]=0,fvys[fvpos]=0,fvpos++,fvpos>=vfc&&(fvpos=0)),view_xx=snake.xx+snake.fx+fvx,view_yy=snake.yy+snake.fy+fvy,choosing_skin&&(view_xx-=104,gsc=1),view_ang=Math.atan2(view_yy-grd,view_xx-grd),view_dist=Math.sqrt((view_xx-grd)*(view_xx-grd)+(view_yy-grd)*(view_yy-grd)),bpx1=view_xx-(mww2/gsc+84),bpy1=view_yy-(mhh2/gsc+84),bpx2=view_xx+(mww2/gsc+84),bpy2=view_yy+(mhh2/gsc+84),fpx1=view_xx-(mww2/gsc+24),fpy1=view_yy-(mhh2/gsc+24),fpx2=view_xx+(mww2/gsc+24),fpy2=view_yy+(mhh2/gsc+24)),bgx2-=1*(view_xx-e)/bgw2,bgy2-=1*(view_yy-s)/bgh2,bgx2%=1,0>bgx2&&(bgx2+=1),bgy2%=1,0>bgy2&&(bgy2+=1),ggbg&&(high_quality||gla>0)?(t.save(),t.fillStyle="#000000",t.fillRect(0,0,mww,mhh),t.globalAlpha=.3*gla,t.drawImage(gbgmc,0,0),t.restore()):(t.fillStyle="#000000",t.fillRect(0,0,mww,mhh)),bgp2&&(t.save(),t.fillStyle=bgp2,t.translate(mww2,mhh2),t.scale(gsc,gsc),t.translate(bgx2*bgw2,bgy2*bgh2),t.globalAlpha=.4+.6*(1-gla),t.fillRect(3*-mww/gsc,3*-mhh/gsc,5*mww/gsc,5*mhh/gsc),(high_quality||gla>0)&&(t.globalCompositeOperation="lighter",t.globalAlpha=.4*gla,t.fillRect(3*-mww/gsc,3*-mhh/gsc,5*mww/gsc,5*mhh/gsc)),t.restore()),testing)for(e=sectors.length-1;e>=0;e--)s=sectors[e],t.fillStyle="rgba(0, 255, 0, .1)",t.fillRect(mww2+(s.xx*sector_size-view_xx)*gsc,mhh2+(s.yy*sector_size-view_yy)*gsc,sector_size*gsc-4,sector_size*gsc-4);if(high_quality||gla>0){var a=1.75;for(1!=gla&&(a=1.75*gla),t.save(),e=foods_c-1;e>=0;e--)s=foods[e],s.rx>=fpx1&&s.ry>=fpy1&&s.rx<=fpx2&&s.ry<=fpy2&&(1==s.rad?(y=mww2+gsc*(s.rx-view_xx)-s.ofw2,m=mhh2+gsc*(s.ry-view_yy)-s.ofh2,y>=-50&&m>=-50&&mwwp50>=y&&mhhp50>=m&&(t.globalAlpha=a*s.fr,t.drawImage(s.ofi,y,m))):(y=mww2+gsc*(s.rx-view_xx)-s.ofw2*s.rad,m=mhh2+gsc*(s.ry-view_yy)-s.ofh2*s.rad,y>=-50&&m>=-50&&mwwp50>=y&&mhhp50>=m&&(t.globalAlpha=a*s.fr,t.drawImage(s.ofi,0,0,s.ofw,s.ofh,y,m,s.ofw*s.rad,s.ofh*s.rad))));t.restore()}if(t.save(),t.globalCompositeOperation="lighter",high_quality||gla>0){a=.75,1!=gla&&(a=.75*gla);var l=.75;for(1!=gla&&(l=1-.25*gla),e=foods_c-1;e>=0;e--)s=foods[e],s.rx>=fpx1&&s.ry>=fpy1&&s.rx<=fpx2&&s.ry<=fpy2&&(1==s.rad?(y=mww2+gsc*(s.rx-view_xx)-s.fw2,m=mhh2+gsc*(s.ry-view_yy)-s.fh2,y>=-50&&m>=-50&&mwwp50>=y&&mhhp50>=m&&(t.globalAlpha=l*s.fr,t.drawImage(s.fi,y,m),t.globalAlpha=a*(.5+.5*Math.cos(s.gfr/13))*s.fr,t.drawImage(s.fi,y,m))):(y=mww2+gsc*(s.rx-view_xx)-s.fw2*s.rad,m=mhh2+gsc*(s.ry-view_yy)-s.fh2*s.rad,y>=-50&&m>=-50&&mwwp50>=y&&mhhp50>=m&&(t.globalAlpha=l*s.fr,t.drawImage(s.fi,0,0,s.fw,s.fh,y,m,s.fw*s.rad,s.fh*s.rad),t.globalAlpha=a*(.5+.5*Math.cos(s.gfr/13))*s.fr,t.drawImage(s.fi,0,0,s.fw,s.fh,y,m,s.fw*s.rad,s.fh*s.rad))))}else for(e=foods_c-1;e>=0;e--)s=foods[e],s.rx>=fpx1&&s.ry>=fpy1&&s.rx<=fpx2&&s.ry<=fpy2&&(1==s.rad?(y=mww2+gsc*(s.rx-view_xx)-s.fw2,m=mhh2+gsc*(s.ry-view_yy)-s.fh2,y>=-50&&m>=-50&&mwwp50>=y&&mhhp50>=m&&(t.globalAlpha=s.fr,t.drawImage(s.fi,y,m))):(y=mww2+gsc*(s.rx-view_xx)-s.fw2*s.rad,m=mhh2+gsc*(s.ry-view_yy)-s.fh2*s.rad,y>=-50&&m>=-50&&mwwp50>=y&&mhhp50>=m&&(t.globalAlpha=s.fr,t.drawImage(s.fi,0,0,s.fw,s.fh,y,m,s.fw*s.rad,s.fh*s.rad))));for(t.restore(),t.save(),t.globalCompositeOperation="lighter",e=preys.length-1;e>=0;e--)if(a=preys[e],i=a.xx+a.fx,r=a.yy+a.fy,px=mww2+gsc*(i-view_xx),py=mhh2+gsc*(r-view_yy),px>=-50&&py>=-50&&mwwp50>=px&&mhhp50>=py){if(a.eaten){var s=a.eaten_by,o=Math.pow(a.eaten_fr,2),i=i+(s.xx+s.fx+Math.cos(s.ang+s.fa)*(43-24*o)*(1-o)-i)*o,r=r+(s.yy+s.fy+Math.sin(s.ang+s.fa)*(43-24*o)*(1-o)-r)*o;px=mww2+gsc*(i-view_xx),py=mhh2+gsc*(r-view_yy)}1==a.rad?(y=px-a.fw2,m=py-a.fh2,t.globalAlpha=.75*a.fr,t.drawImage(a.fi,y,m),t.globalAlpha=.75*(.5+.5*Math.cos(a.gfr/13))*a.fr,t.drawImage(a.fi,y,m)):(y=px-a.fw2*a.rad,m=py-a.fh2*a.rad,t.globalAlpha=.75*a.fr,t.drawImage(a.fi,0,0,a.fw,a.fh,y,m,a.fw*a.rad,a.fh*a.rad),t.globalAlpha=.75*(.5+.5*Math.cos(a.gfr/13))*a.fr,t.drawImage(a.fi,0,0,a.fw,a.fh,y,m,a.fw*a.rad,a.fh*a.rad))}t.restore(),t.save(),t.strokeStyle="#90C098";for(var i,r,c,e=snakes.length-1;e>=0;e--)s=snakes[e],i=s.xx+s.fx,r=s.yy+s.fy+40,0<s.na&&i>=bpx1-100&&r>=bpy1&&bpx2+100>=i&&bpy2>=r&&(s==snake&&(s.fnfr++,200<s.fnfr&&(s.na-=.004,0>s.na&&(s.na=0))),t.save(),t.globalAlpha=.5*s.na*s.alive_amt*(1-s.dead_amt),t.font="12px Arial, Helvetica Neue, Helvetica, sans-serif",t.fillStyle=s.csw,t.textBaseline="middle",t.textAlign="center",a=s.xx+s.fx,l=s.yy+s.fy,a=mww2+(a-view_xx)*gsc,l=mhh2+(l-view_yy)*gsc,t.fillText(s.nk,a,l+32+11*s.sc*gsc),t.restore());for(e=snakes.length-1;e>=0;e--)for(s=snakes[e],s.iiv=!1,h=s.pts.length-1;h>=0;h--)if(i=s.pts[h],px=i.xx+i.fx,py=i.yy+i.fy,px>=bpx1&&py>=bpy1&&bpx2>=px&&bpy2>=py){s.iiv=!0;break}for(e=snakes.length-1;e>=0;e--)if(s=snakes[e],s.iiv){a=s.xx+s.fx,l=s.yy+s.fy,px=a,py=l,c=s.ehang;var p=s.sc,g=29*p,f=s.cfl;if(i=s.pts[s.pts.length-1],1==render_mode){t.save(),t.beginPath(),t.moveTo(mww2+(px-view_xx)*gsc,mhh2+(py-view_yy)*gsc),r=!1;for(var h=s.pts.length-1;h>=0;h--){i=s.pts[h],lpx=px,lpy=py,px=i.xx,py=i.yy;var y=i.fx,m=i.fy;f>0&&(px+=y,py+=m,lax=ax,lay=ay,ax=(px+lpx)/2,ay=(py+lpy)/2,r||(lax=ax,lay=ay),1>f&&(o=1-f,lpx+=(lax-lpx)*o,lpy+=(lay-lpy)*o,ax+=(lax-ax)*o,ay+=(lay-ay)*o),r?f--:f-=s.chl+s.fchl,r?t.quadraticCurveTo(mww2+(lpx-view_xx)*gsc,mhh2+(lpy-view_yy)*gsc,mww2+(ax-view_xx)*gsc,mhh2+(ay-view_yy)*gsc):(t.lineTo(mww2+(ax-view_xx)*gsc,mhh2+(ay-view_yy)*gsc),r=!0))}t.save(),t.lineJoin="round",t.lineCap="round",is_firefox?(s.sp>s.fsp&&(h=s.alive_amt*(1-s.dead_amt)*Math.max(0,Math.min(1,(s.sp-s.ssp)/(s.msp-s.ssp))),t.save(),t.strokeStyle=s.cs,t.globalAlpha=.3*h,t.lineWidth=(g+6)*gsc,t.stroke(),t.lineWidth=(g+9)*gsc,t.stroke(),t.lineWidth=(g+12)*gsc,t.stroke(),t.restore()),t.globalAlpha=1*s.alive_amt*(1-s.dead_amt),t.strokeStyle="#000000",t.lineWidth=(g+5)*gsc):(s.sp>s.fsp&&(h=s.alive_amt*(1-s.dead_amt)*Math.max(0,Math.min(1,(s.sp-s.ssp)/(s.msp-s.ssp))),t.save(),t.lineWidth=(g-2)*gsc,t.shadowBlur=30*gsc,t.shadowColor="rgba("+s.rr+","+s.gg+","+s.bb+", "+Math.round(1e4*h)/1e4+")",t.stroke(),t.stroke(),t.restore()),t.globalAlpha=.4*s.alive_amt*(1-s.dead_amt),t.strokeStyle="#000000",t.lineWidth=(g+5)*gsc,t.stroke(),t.strokeStyle=s.cs,t.lineWidth=g*gsc,t.strokeStyle="#000000",t.globalAlpha=1*s.alive_amt*(1-s.dead_amt)),t.stroke(),t.strokeStyle=s.cs,t.globalAlpha=.8*s.alive_amt*(1-s.dead_amt),t.lineWidth=g*gsc,t.stroke(),t.restore(),t.strokeStyle=s.cs,s.dead&&(m=(.5+.5*Math.abs(Math.sin(5*Math.PI*s.dead_amt)))*Math.sin(Math.PI*s.dead_amt),t.save(),t.lineJoin="round",t.lineCap="round",t.globalCompositeOperation="lighter",t.lineWidth=(g-3)*gsc,t.globalAlpha=m,t.strokeStyle="#FFCC99",t.stroke(),t.restore()),t.restore()}if(2==render_mode){var d,x,w,v,b,u,_,k,g=.5*g,y=0;px=a,py=l,b=px,u=py,b>=bpx1&&u>=bpy1&&bpx2>=b&&bpy2>=u?(pbx[0]=b,pby[0]=u,pba[0]=Math.atan2(l-(i.yy+i.fy),a-(i.xx+i.fx))+Math.PI,pbu[0]=1):pbu[0]=0,y=1,n=(s.chl+s.fchl)%.25,0>n&&(n+=.25),n=.25-n,f+=1-.25*Math.ceil((s.chl+s.fchl)/.25),ax=px,ay=py,s.sep!=s.wsep&&(s.sep<s.wsep?(s.sep+=.01,s.sep>=s.wsep&&(s.sep=s.wsep)):s.sep>s.wsep&&(s.sep-=.01,s.sep<=s.wsep&&(s.sep=s.wsep)));for(var M,I,z=s.sep*qsm,C=0,m=per_color_imgs[s.cv].kmcs,h=s.pts.length-1;h>=0;h--)if(i=s.pts[h],lpx=px,lpy=py,px=i.xx+i.fx,py=i.yy+i.fy,f>-.25){for(w=b,v=u,b=(px+lpx)/2,u=(py+lpy)/2,_=lpx,k=lpy,o=0;1>o;o+=.25){if(M=n+o,i=w+(_-w)*M,r=v+(k-v)*M,d=_+(b-_)*M,x=k+(u-k)*M,lax=ax,lay=ay,ax=i+(d-i)*M,ay=r+(x-r)*M,0>f&&(ax+=-(lax-ax)*f/.25,ay+=-(lay-ay)*f/.25),d=Math.sqrt(Math.pow(ax-lax,2)+Math.pow(ay-lay,2)),z>C+d)C+=d;else{for(C=-C,M=(d-C)/z;M>=1;M--)C+=z,pax=lax+(ax-lax)*C/d,pay=lay+(ay-lay)*C/d,pax>=bpx1&&pay>=bpy1&&bpx2>=pax&&bpy2>=pay?(pbx[y]=pax,pby[y]=pay,pbu[y]=1,i=ax-lax,r=ay-lay,pba[y]=i>=-15&&r>=-15&&15>i&&15>r?at2lt[8*r+128<<8|8*i+128]:i>=-127&&r>=-127&&127>i&&127>r?at2lt[r+128<<8|i+128]:Math.atan2(r,i)):pbu[y]=0,y++;C=d-C}if(1>f&&(f-=.25,-.25>=f))break}f>=1&&f--}if(ax>=bpx1&&ay>=bpy1&&bpx2>=ax&&bpy2>=ay?(pbu[y]=1,pbx[y]=ax,pby[y]=ay,pba[y]=Math.atan2(ay-lay,ax-lax)):pbu[y]=0,y++,t.save(),t.translate(mww2,mhh2),o=gsc*g*52/32,b=gsc*g*62/32,f=s.alive_amt*(1-s.dead_amt),f*=f,M=1,s.tsp>s.fsp){if(M=s.alive_amt*(1-s.dead_amt)*Math.max(0,Math.min(1,(s.tsp-s.ssp)/(s.msp-s.ssp))),I=.37*M,r=Math.pow(M,.5),C=gsc*g*(1+.9375*r),i=per_color_imgs[s.cv].kfmc,t.save(),t.globalCompositeOperation="lighter",s.rbcs)for(u=s.rbcs,z=u.length,h=y-1;h>=0;h--)1==pbu[h]&&(px=pbx[h],py=pby[h],i=per_color_imgs[u[h%z]],i=i.kfmc,t.save(),t.globalAlpha=f*r*.38*(.6+.4*Math.cos(h/4-1.15*s.sfr)),t.translate((px-view_xx)*gsc,(py-view_yy)*gsc),t.drawImage(i,-C,-C,2*C,2*C),t.restore());else for(h=y-1;h>=0;h--)1==pbu[h]&&(px=pbx[h],py=pby[h],t.save(),t.globalAlpha=f*r*.38*(.6+.4*Math.cos(h/4-1.15*s.sfr)),t.translate((px-view_xx)*gsc,(py-view_yy)*gsc),t.drawImage(i,-C,-C,2*C,2*C),t.restore());t.restore(),M=1-M}if(M*=f,high_quality||gla>0)for(i=M,1!=gla&&(i=M*gla),t.globalAlpha=i,h=y-1;h>=0;h--)1==pbu[h]&&(px=pbx[h],py=pby[h],t.save(),t.translate((px-view_xx)*gsc,(py-view_yy)*gsc),t.drawImage(komc,-o,-o,2*o,2*o),9>h&&(t.globalAlpha=i*(1-h/9),t.drawImage(ksmc,-b,-b,2*b,2*b),t.globalAlpha=i),t.restore());if(t.globalAlpha=M,s.rbcs){for(u=s.rbcs,z=u.length,h=y-1;h>=0;h--)1==pbu[h]&&(px=pbx[h],py=pby[h],h>=2&&(o=h-2,1==pbu[o]&&(i=pbx[o],r=pby[o],t.save(),t.translate((i-view_xx)*gsc,(r-view_yy)*gsc),t.globalAlpha=9>o?o/9*M:M,t.drawImage(ksmc,-b,-b,2*b,2*b),t.restore())),t.save(),t.globalAlpha=f,t.translate((px-view_xx)*gsc,(py-view_yy)*gsc),t.rotate(pba[h]),o=h%(2*m.length),o>=m.length&&(o=2*m.length-(o+1)),i=per_color_imgs[u[h%z]],t.drawImage(i.kmcs[o],-gsc*g,-gsc*g,2*gsc*g,2*gsc*g),t.restore());if(s.tsp>s.fsp&&(high_quality||gla>0)){for(t.save(),t.globalCompositeOperation="lighter",h=y-1;h>=0;h--)1==pbu[h]&&(px=pbx[h],py=pby[h],t.save(),t.translate((px-view_xx)*gsc,(py-view_yy)*gsc),t.rotate(pba[h]),t.globalAlpha=f*I*gla*(.5+.5*Math.cos(h/4-s.sfr)),o=h%(2*m.length),o>=m.length&&(o=2*m.length-(o+1)),t.drawImage(per_color_imgs[u[h%z]].kmcs[o],-gsc*g,-gsc*g,2*gsc*g,2*gsc*g),t.restore());t.restore()}}else{for(h=y-1;h>=0;h--)1==pbu[h]&&(px=pbx[h],py=pby[h],h>=2&&(o=h-2,1==pbu[o]&&(i=pbx[o],r=pby[o],t.save(),t.translate((i-view_xx)*gsc,(r-view_yy)*gsc),t.globalAlpha=9>o?o/9*M:M,t.drawImage(ksmc,-b,-b,2*b,2*b),t.restore())),t.save(),t.globalAlpha=f,t.translate((px-view_xx)*gsc,(py-view_yy)*gsc),t.rotate(pba[h]),o=h%(2*m.length),o>=m.length&&(o=2*m.length-(o+1)),t.drawImage(m[o],-gsc*g,-gsc*g,2*gsc*g,2*gsc*g),t.restore());if(s.tsp>s.fsp&&(high_quality||gla>0)){for(t.save(),t.globalCompositeOperation="lighter",h=y-1;h>=0;h--)1==pbu[h]&&(px=pbx[h],py=pby[h],o=h%(2*m.length),o>=m.length&&(o=2*m.length-(o+1)),t.save(),t.translate((px-view_xx)*gsc,(py-view_yy)*gsc),t.rotate(pba[h]),t.globalAlpha=f*I*gla*(.5+.5*Math.cos(h/4-s.sfr)),t.drawImage(m[o],-gsc*g,-gsc*g,2*gsc*g,2*gsc*g),t.restore());t.restore()}}if(s.antenna&&y>=2&&1==pbu[1]){if(s.atx[0]=pbx[1],s.aty[0]=pby[1],M=s.sc*gsc,fj=s.atx.length-1,choosing_skin)for(h=1;fj>=h;h++)s.atvx[h]-=.3,s.atvy[h]+=.14*Math.cos(fr/23-7*h/fj);for(h=1;fj>=h;h++)xx=s.atx[h-1],yy=s.aty[h-1],xx+=2*Math.random()-1,yy+=2*Math.random()-1,i=s.atx[h]-xx,r=s.aty[h]-yy,ang=i>=-4&&r>=-4&&4>i&&4>r?at2lt[32*r+128<<8|32*i+128]:i>=-8&&r>=-8&&8>i&&8>r?at2lt[16*r+128<<8|16*i+128]:i>=-16&&r>=-16&&16>i&&16>r?at2lt[8*r+128<<8|8*i+128]:i>=-127&&r>=-127&&127>i&&127>r?at2lt[r+128<<8|i+128]:Math.atan2(r,i),xx+=4*Math.cos(ang)*s.sc,yy+=4*Math.sin(ang)*s.sc,s.atvx[h]+=.1*(xx-s.atx[h]),s.atvy[h]+=.1*(yy-s.aty[h]),s.atx[h]+=s.atvx[h],s.aty[h]+=s.atvy[h],s.atvx[h]*=.88,s.atvy[h]*=.88,i=s.atx[h]-s.atx[h-1],r=s.aty[h]-s.aty[h-1],d=Math.sqrt(i*i+r*r),d>4*s.sc&&(ang=i>=-4&&r>=-4&&4>i&&4>r?at2lt[32*r+128<<8|32*i+128]:i>=-8&&r>=-8&&8>i&&8>r?at2lt[16*r+128<<8|16*i+128]:i>=-16&&r>=-16&&16>i&&16>r?at2lt[8*r+128<<8|8*i+128]:i>=-127&&r>=-127&&127>i&&127>r?at2lt[r+128<<8|i+128]:Math.atan2(r,i),s.atx[h]=s.atx[h-1]+4*Math.cos(ang)*s.sc,s.aty[h]=s.aty[h-1]+4*Math.sin(ang)*s.sc);for(t.globalAlpha=f,t.strokeStyle=s.atc1,t.lineWidth=5*M,t.lineCap="round",t.lineJoin="round",t.beginPath(),fj=s.atx.length-1,i=(s.atx[fj]-view_xx)*gsc,r=(s.aty[fj]-view_yy)*gsc,t.moveTo(i,r),h=fj-1;h>=1;h--)xx=(s.atx[h]-view_xx)*gsc,yy=(s.aty[h]-view_yy)*gsc,1<=Math.abs(xx-i)+Math.abs(yy-r)&&(i=xx,r=yy,t.lineTo(i,r));for(xx=(.5*(s.atx[1]+s.atx[0])-view_xx)*gsc,yy=(.5*(s.aty[1]+s.aty[0])-view_yy)*gsc,1<=Math.abs(xx-i)+Math.abs(yy-r)&&(i=xx,r=yy,t.lineTo(i,r)),t.stroke(),t.globalAlpha=s.atia*f,t.strokeStyle=s.atc2,t.lineWidth=4*M,t.beginPath(),fj=s.atx.length-1,i=(s.atx[fj]-view_xx)*gsc,r=(s.aty[fj]-view_yy)*gsc,t.moveTo(i,r),h=fj-1;h>=0;h--)xx=(s.atx[h]-view_xx)*gsc,yy=(s.aty[h]-view_yy)*gsc,1<=Math.abs(xx-i)+Math.abs(yy-r)&&(i=xx,r=yy,t.lineTo(i,r));t.stroke(),s.atwg&&(t.lineWidth=3*M,t.stroke(),t.lineWidth=2*M,t.stroke()),t.globalAlpha=f*s.blba,s.abrot?(t.save(),t.translate((s.atx[fj]-view_xx)*gsc,(s.aty[fj]-view_yy)*gsc),vang=Math.atan2(s.aty[fj]-s.aty[fj-1],s.atx[fj]-s.atx[fj-1])-s.atba,(0>vang||vang>=pi2)&&(vang%=pi2),vang<-Math.PI?vang+=pi2:vang>Math.PI&&(vang-=pi2),s.atba=(s.atba+.15*vang)%pi2,t.rotate(s.atba),t.drawImage(s.bulb,s.blbx*s.bsc*M,s.blby*s.bsc*M,s.blbw*s.bsc*M,s.blbh*s.bsc*M),t.restore()):t.drawImage(s.bulb,(s.atx[fj]-view_xx+s.blbx*s.bsc*s.sc)*gsc,(s.aty[fj]-view_yy+s.blby*s.bsc*s.sc)*gsc,s.blbw*s.bsc*M,s.blbh*s.bsc*M),s.apbs&&(t.globalAlpha=.5*f,t.lineWidth=3*M,t.stroke(),t.lineWidth=2*M,t.stroke())}if(s.dead){for(t.save(),t.globalCompositeOperation="lighter",m=(.15+.15*Math.abs(Math.sin(5*Math.PI*s.dead_amt)))*Math.sin(Math.PI*s.dead_amt),g*=gsc,h=y-1;h>=0;h--)1==pbu[h]&&(px=pbx[h],py=pby[h],t.save(),t.globalAlpha=m*(.6+.4*Math.cos(h/4-15*s.dead_amt)),t.translate((px-view_xx)*gsc,(py-view_yy)*gsc),t.drawImage(kdmc,-g,-g,2*g,2*g),t.restore());t.restore()}t.restore()}h=1==render_mode?4*p:6*p,g=6*p,y=Math.cos(c)*h+Math.cos(c-Math.PI/2)*(g+.5),m=Math.sin(c)*h+Math.sin(c-Math.PI/2)*(g+.5),t.fillStyle=s.ec,t.globalAlpha=s.eca*s.alive_amt,t.beginPath(),t.arc(mww2+(y+a-view_xx)*gsc,mhh2+(m+l-view_yy)*gsc,s.er*p*gsc,0,pi2),t.closePath(),t.fill(),t.globalAlpha=s.ppa,y=Math.cos(c)*(h+.5)+s.rex*p+Math.cos(c-Math.PI/2)*g,m=Math.sin(c)*(h+.5)+s.rey*p+Math.sin(c-Math.PI/2)*g,t.fillStyle=s.ppc,t.beginPath(),t.arc(mww2+(y+a-view_xx)*gsc,mhh2+(m+l-view_yy)*gsc,3.5*p*gsc,0,pi2),t.closePath(),t.fill(),y=Math.cos(c)*h+Math.cos(c+Math.PI/2)*(g+.5),m=Math.sin(c)*h+Math.sin(c+Math.PI/2)*(g+.5),t.fillStyle=s.ec,t.globalAlpha=s.eca*s.alive_amt,t.beginPath(),t.arc(mww2+(y+a-view_xx)*gsc,mhh2+(m+l-view_yy)*gsc,s.er*p*gsc,0,pi2),t.closePath(),t.fill(),t.globalAlpha=s.ppa,y=Math.cos(c)*(h+.5)+s.rex*p+Math.cos(c+Math.PI/2)*g,m=Math.sin(c)*(h+.5)+s.rey*p+Math.sin(c+Math.PI/2)*g,t.fillStyle=s.ppc,t.beginPath(),t.arc(mww2+(y+a-view_xx)*gsc,mhh2+(m+l-view_yy)*gsc,3.5*p*gsc,0,pi2),t.closePath(),t.fill(),t.globalAlpha=1}if(high_quality||gla>0){for(t.save(),t.globalCompositeOperation="lighter",e=foods_c-1;e>=0;e--)s=foods[e],s.rx>=fpx1&&s.ry>=fpy1&&s.rx<=fpx2&&s.ry<=fpy2&&(i=s.rx-view_xx,r=s.ry-view_yy,a=i*i+r*r,fs=1+.06*s.rad,y=i*fs,m=r*fs,I=.005+.09*(1-a/(86e3+a)),1!=s.rad&&(I*=Math.pow(s.rad,.25)),1!=gla&&(I*=gla),y=y*gsc+mww2,m=m*gsc+mhh2,1==s.rad?y>=-150&&m>=-150&&mwwp150>=y&&mhhp150>=m&&(y-=s.gfw2,m-=s.gfh2,t.globalAlpha=I*s.fr,t.drawImage(s.gfi,y,m),t.globalAlpha=I*(.5+.5*Math.cos(s.gfr/13))*s.fr,t.drawImage(s.gfi,y,m)):y>=-150&&m>=-150&&mwwp150>=y&&mhhp150>=m&&(y-=s.gfw2*s.rad,m-=s.gfh2*s.rad,t.globalAlpha=I*s.fr,t.drawImage(s.gfi,0,0,s.gfw,s.gfh,y,m,s.gfw*s.rad,s.gfh*s.rad),t.globalAlpha=I*(.5+.5*Math.cos(s.gfr/13))*s.fr,t.drawImage(s.gfi,0,0,s.gfw,s.gfh,y,m,s.gfw*s.rad,s.gfh*s.rad)),fs=1+.32*s.rad,y=i*fs,m=r*fs,I=.085*(1-a/(16500+a)),1!=s.rad&&(I*=Math.pow(s.rad,.25)),1!=gla&&(I*=gla),y=y*gsc+mww2,m=m*gsc+mhh2,1==s.rad?y>=-150&&m>=-150&&mwwp150>=y&&mhhp150>=m&&(y-=s.g2fw2,m-=s.g2fh2,t.globalAlpha=I*s.fr,t.drawImage(s.g2fi,y,m),t.globalAlpha=I*(.5+.5*Math.cos(s.gfr/13))*s.fr,t.drawImage(s.g2fi,y,m)):y>=-150&&m>=-150&&mwwp150>=y&&mhhp150>=m&&(y-=s.g2fw2*s.rad,m-=s.g2fh2*s.rad,t.globalAlpha=I*s.fr,t.drawImage(s.g2fi,0,0,s.g2fw,s.g2fh,y,m,s.g2fw*s.rad,s.g2fh*s.rad),t.globalAlpha=I*(.5+.5*Math.cos(s.gfr/13))*s.fr,t.drawImage(s.g2fi,0,0,s.g2fw,s.g2fh,y,m,s.g2fw*s.rad,s.g2fh*s.rad)));t.restore()}for(t.save(),t.globalCompositeOperation="lighter",e=preys.length-1;e>=0;e--)a=preys[e],i=a.xx+a.fx,r=a.yy+a.fy,a.eaten&&(s=a.eaten_by,o=Math.pow(a.eaten_fr,2),i+=(s.xx+s.fx+Math.cos(s.ang+s.fa)*(43-24*o)*(1-o)-i)*o,r+=(s.yy+s.fy+Math.sin(s.ang+s.fa)*(43-24*o)*(1-o)-r)*o),i-=view_xx,r-=view_yy,s=i*i+r*r,fs=1+.08*a.rad,px=i*fs,py=r*fs,I=.4*(1-s/(176e3+s)),1!=a.rad&&(I*=Math.pow(a.rad,.25)),px=px*gsc+mww2,py=py*gsc+mhh2,1==a.rad?px>=-150&&py>=-150&&mwwp150>=px&&mhhp150>=py&&(px-=a.gfw2,py-=a.gfh2,t.globalAlpha=I*a.fr,t.drawImage(a.gfi,px,py),t.globalAlpha=I*(.5+.5*Math.cos(a.gfr/13))*a.fr,t.drawImage(a.gfi,px,py)):px>=-150&&py>=-150&&mwwp150>=px&&mhhp150>=py&&(px-=a.gfw2*a.rad,py-=a.gfh2*a.rad,t.globalAlpha=I*a.fr,t.drawImage(a.gfi,0,0,a.gfw,a.gfh,px,py,a.gfw*a.rad,a.gfh*a.rad),t.globalAlpha=I*(.5+.5*Math.cos(a.gfr/13))*a.fr,t.drawImage(a.gfi,0,0,a.gfw,a.gfh,px,py,a.gfw*a.rad,a.gfh*a.rad)),fs=1+.32*a.rad,px=i*fs,py=r*fs,I=.35*(1-s/(46500+s)),1!=a.rad&&(I*=Math.pow(a.rad,.25)),s=2*a.rad,px=px*gsc+mww2,py=py*gsc+mhh2,px>=-150&&py>=-150&&mwwp150>=px&&mhhp150>=py&&(px-=a.gfw2*s,py-=a.gfh2*s,t.globalAlpha=I*a.fr,t.drawImage(a.gfi,0,0,a.gfw,a.gfh,px,py,a.gfw*s,a.gfh*s),t.globalAlpha=I*(.5+.5*Math.cos(a.gfr/13))*a.fr,t.drawImage(a.gfi,0,0,a.gfw,a.gfh,px,py,a.gfw*s,a.gfh*s));if(t.restore(),4e3>Math.abs(grd-view_dist)){for(t.save(),t.lineWidth=23*gsc,t.strokeStyle="#800000",t.fillStyle="#300000",t.beginPath(),xx=grd+Math.cos(view_ang-2e3/grd)*grd*.98,yy=grd+Math.sin(view_ang-2e3/grd)*grd*.98,t.moveTo(mww2+(xx-view_xx)*gsc,mhh2+(yy-view_yy)*gsc),h=-2e3;2e3>=h;h+=100)xx=grd+Math.cos(view_ang+h/grd)*grd*.98,yy=grd+Math.sin(view_ang+h/grd)*grd*.98,t.lineTo(mww2+(xx-view_xx)*gsc,mhh2+(yy-view_yy)*gsc);xx=grd+Math.cos(view_ang+2e3/grd)*(grd+4e3),yy=grd+Math.sin(view_ang+2e3/grd)*(grd+4e3),t.lineTo(mww2+(xx-view_xx)*gsc,mhh2+(yy-view_yy)*gsc),xx=grd+Math.cos(view_ang-2e3/grd)*(grd+4e3),yy=grd+Math.sin(view_ang-2e3/grd)*(grd+4e3),t.lineTo(mww2+(xx-view_xx)*gsc,mhh2+(yy-view_yy)*gsc),t.closePath(),t.stroke(),t.fill(),t.restore()}wumsts&&rank>0&&snake_count>0&&playing&&(wumsts=!1,s="Your length",e="of",I="Your rank","DE"==country?(s="Deine Länge",e="von",I="Dein rang"):"FR"==country?(s="Votre longueur",e="de",I="Ton rang"):"BR"==country&&(s="Seu comprimento",e="do",I="Seu classificação"),s=""+('<span style="font-size: 14px;"><span style="opacity: .4;">'+s+': </span><span style="opacity: .8; font-weight: bold;">'+Math.floor(150*(fpsls[snake.sct]+snake.fam/fmlts[snake.sct]-1)-50)/10+"</span></span>"),s+='<BR><span style="opacity: .3;">'+I+': </span><span style="opacity: .35;">'+rank+'</span><span style="opacity: .3;"> '+e+' </span><span style="opacity: .35;">'+snake_count+"</span>",lbf.innerHTML=s),t.restore()}},ww=window.innerWidth,hh=window.innerHeight,lww=0,lhh=0,csc,grd=16384;for(window.onresize=function(){resize()},i=ois.length-1;i>=0;i--)ois[i].ii.src=ois[i].src;0==wic&&startAnimation(),window.onmousemove=function(t){(t=t||window.event)&&"undefined"!=typeof t.clientX&&(xm=t.clientX-ww/2,ym=t.clientY-hh/2)},window.oncontextmenu=function(t){return t.preventDefault(),t.stopPropagation(),!1},window.ontouchmove=function(t){dmutm=Date.now()+1500,null!=snake&&(t=t||window.event)&&(t=t.touches[0],"undefined"!=typeof t.clientX?(xm=t.clientX-ww/2,ym=t.clientY-hh/2):(xm=t.pageX-ww/2,ym=t.pageY-hh/2))};var dmutm=0,ltchx=-1,ltchy=-1,ltchmtm=-1;window.ontouchstart=function(t){if(dmutm=Date.now()+1500,null!=snake){if(t=t||window.event){var e,s;s=t.touches[0],"undefined"!=typeof s.clientX?(e=s.clientX-ww/2,s=s.clientY-hh/2):(e=s.pageX-ww/2,s=s.pageY-hh/2);var a=Date.now();24>Math.abs(e-ltchx)&&24>Math.abs(s-ltchy)&&400>a-ltchmtm&&setAcceleration(1),ltchx=e,ltchy=s,ltchmtm=a,xm=e,ym=s}t.preventDefault()}},window.onmousedown=function(t){(0==dmutm||Date.now()>dmutm)&&(dmutm=0,null!=snake&&(window.onmousemove(t),setAcceleration(1),t.preventDefault()))},window.ontouchend=function(){setAcceleration(0)},window.addEventListener("mouseup",omu);var mscps=0,fmlts=[],fpsls=[],etm=0,ws=null,tcsecs=0,trdps=0,rdps=0,rfps=0,rnps=0,rsps=0,reps=0,rdpspc=[],anguc=0,angnuc=0,wangnuc=0,lrd_mtm=Date.now(),locu_mtm=0;if(testing)for(i=0;256>i;i++)rdpspc[i]=-1;var pfs=[],pft=0,pf1=0,pf2=0,rpf1,rpf2,pf_nap=0,pf_ep=0,rpft=0,pf;for(i=0;100>i;i++)pfs.push(0);var pf_add=0,pf_new_add=0,pf_remove=0,tpfa=new Float32Array(4e4);for(i=0;i<tpfa.length;i++)tpfa[i]=32*Math.random();var pfd;testing&&(pfd=document.createElement("div"),pfd.style.position="fixed",pfd.style.left="4px",pfd.style.bottom="69px",pfd.style.width="170px",pfd.style.height="364px",pfd.style.background="rgba(0, 0, 0, .8)",pfd.style.color="#80FF80",pfd.style.fontFamily="Verdana",pfd.style.zIndex=999999,pfd.style.fontSize="11px",pfd.style.padding="10px",pfd.style.borderRadius="30px",pfd.textContent="ayy lmao",document.body.appendChild(pfd));var protocol_version=2,connecting=!1,start_connect_mtm,play_btn_click_mtm=-1,waiting_for_sos=!1,sos_ready_after_mtm=-1,smh=document.getElementById("smh"),cstx=document.getElementById("cstx");cstx.src="FR"==country?"/s/customskins-fr.png":"BR"==country?"/s/customskins-br.png":"/s/customskins2.png";try{"1"!=localStorage.edttsg&&(cstx.style.display="inline")}catch(b){}var fb=document.getElementById("fb");fb.href="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent("http://slither.io"),fb.onclick=function(){localStorage.edttsg="1"};var fbh=document.getElementById("fbh"),twt=document.getElementById("twt");twt.onclick=function(){localStorage.edttsg="1"},twt.href="http://twitter.com/intent/tweet?status="+encodeURIComponent("Come and play http://slither.io #slitherio");var twth=document.getElementById("twth"),csk=document.getElementById("csk"),cskh=document.getElementById("cskh"),want_quality=1,grq=document.getElementById("grq"),grqh=document.getElementById("grqh"),phqi=document.createElement("img"),grqi=document.getElementById("grqi");try{"0"==localStorage.qual?(grqi.src="/s/lowquality.png",want_quality=0):(phqi.src="/s/lowquality.png",want_quality=1)}catch(b){}grq.onclick=function(){try{"0"==localStorage.qual?(localStorage.qual="1",grqi.src="/s/highquality.png",want_quality=1):(localStorage.qual="0",grqi.src="/s/lowquality.png",want_quality=0)}catch(t){}return!1};var plq=document.getElementById("plq"),clq=document.getElementById("clq");try{"1"==localStorage.edttsg&&(cskh.style.display="inline")}catch(b){}var psk=document.getElementById("psk"),pskh=document.getElementById("pskh"),nsk=document.getElementById("nsk"),nskh=document.getElementById("nskh"),choosing_skin=!1;psk.onclick=function(){if(playing&&null!=snake){var t=snake.rcv;t--,0>t&&(t=max_skin_cv),setSkin(snake,t)}return!1},nsk.onclick=function(){if(playing&&null!=snake){var t=snake.rcv;t++,t>max_skin_cv&&(t=0),setSkin(snake,t)}return!1},csk.onclick=function(){if(!playing&&-1==dead_mtm){resetGame(),choosing_skin=!0,pskh.style.opacity=0,nskh.style.opacity=0,skodiv.style.opacity=0,pskh.style.display="inline",nskh.style.display="inline",skodiv.style.display="inline",skodiv.style.left=Math.round(ww/2-skodiv.offsetWidth/2)+"px",nick.disabled=!0,0==mscps&&setMscps(300),gsc=sgsc;for(var t=[],e=22;e>=1;e--)t.push({xx:grd/2-10*e,yy:grd/2,fx:0,fy:0,exs:[],eys:[],efs:[],ems:[],eiu:0,fpos:0,da:0,ebx:10,eby:0});e=0;try{var s=localStorage.snakercv;s==""+Number(s)&&(e=Number(s))}catch(a){}t=newSnake(1,grd/2,grd/2,e,0,t),view_xx=grd/2-105,view_yy=grd/2,snake=t,t.nk="",t.eang=t.wang=t.ang,t.sp=4.8,t.spang=t.sp/spangdv,1<t.spang&&(t.spang=1),t.sc=1,t.scang=1,t.ssp=nsp1+nsp2*t.sc,t.fsp=t.ssp+.1,t.wsep=6*t.sc,s=nsep/gsc,t.wsep<s&&(t.wsep=s),t.sep=t.wsep,snl(t),t.alive_amt=1,t.rex=1.66,ws={send:function(t){},close:function(){}},high_quality=playing=connected=!0,gla=1,wdfg=0,qsm=1,startShowGame(),lbh.style.display="none",lbs.style.display="none",
lbn.style.display="none",lbp.style.display="none",lbf.style.display="none",vcm.style.display="none",loch.style.display="none"}return!1},nick.oninput=function(){var t=this.value,e=asciize(t);24<e.length&&(e=e.substr(0,24)),t!=e&&(this.value=e)},victory.oninput=function(){var t=this.value,e=asciize(t);140<e.length&&(e=e.substr(0,140)),t!=e&&(this.value=e)},nick.focus();var lmch=document.createElement("div");lmch.style.width="450px",lmch.style.height="115px";var lmc2=document.createElement("canvas"),lmc=document.createElement("canvas"),lgsc=1,lw=900,lh=270;lmc.width=lmc2.width=lw,lmc.height=lmc2.height=lh;var lctx=lmc.getContext("2d"),lctx2=lmc2.getContext("2d");trf(lmc2,"scale(.5, .5)"),trfo(lmc2,"0% 0%"),lmch.appendChild(lmc2),logo.appendChild(lmch);var lts=[];for(lts.push({pts:[107,107,80,83,53,98,31,115,55,131,98,147,101,162,101,190,66,188,49,187,34,173],kc:22,ws:4,wr:.025,qm:.025,sp:.06,sz:11},{pts:[150,30,150,107,150,184],kc:66,ws:4,wr:.05,qm:.025,sp:.06,sz:11},{pts:[207,96,207,140,207,184],kc:46,ws:4,wr:.03,qm:.035,sp:.06,sz:11},{pts:[207,47,207,48.5,207,50],kc:11,ws:2,wr:.06,qm:.05,sp:.06,sz:15,r:.5},{pts:[267,65,267,114.5,267,164,267,194,297,186],kc:66,ws:6,wr:-.025,qm:-.0125,sp:.06,sz:11,r:1.5},{pts:[243,94,268,94,293,94],kc:66,ws:4,wr:.015,qm:.025,sp:.06,sz:9,r:1.2},{pts:[338,30,338,68.5,338,107,338,145.5,338,184,338,164,338,144,338,104,378,104,418,104,418,144,418,164,418,184],kc:46,ws:4,wr:.005,qm:.02,sp:.06,sz:11,r:2.1},{pts:[535,175,500,201,472,175,442,138,472,105,502,84,532,105,546,118,544,139,504,139,464,139],kc:35,ws:6,wr:-.013,qm:-.025,sp:.06,sz:11,r:1.3},{pts:[591,96,591,140,591,184,591,155,591,126,613,82,652,109],kc:38,ws:4,wr:.01,qm:-.035,sp:.06,sz:11},{pts:[663,177,663,178.5,663,180],kc:11,ws:2,wr:.06,qm:.05,sp:.06,sz:15},{pts:[717,96,717,140,717,184],kc:33,ws:4,wr:.06,qm:.05,sp:.06,sz:11},{pts:[717,47,717,48.5,717,50],kc:11,ws:2,wr:.06,qm:.05,sp:.06,sz:15},{pts:[814,186,860,188,858,136,854,96,814,96,770,96,770,136,770,186,814,186],kc:43,ws:4,wr:0,qm:.0274,sp:.073,sz:11,r:1.5}),i=0;i<lts.length;i++)lts[i].mwig=5;var lga=0,lgss=0,ncka=0,mwig=4,lgfr=0,lgtm=Date.now(),showlogo_iv=-1;is_safari||is_mobile?(ncka=lgss=lga=1,showLogo(!0)):showlogo_iv=setInterval("showLogo(false)",25),document.onkeydown=function(t){t=t||window.event;var e=t.keyCode;37==e?kd_l=!0:39==e?kd_r=!0:38==e||32==e?(kd_u=!0,setAcceleration(1)):13==e||10==e?want_victory_message?0<victory.value.length&&save_btn.elem.onclick():connecting||connected||play_btn.elem.onclick():16==e&&testing&&(shifty=!0),testing&&console.log("keydown: "+t.keyCode)},document.onkeyup=function(t){t=t||window.event,t=t.keyCode,37==t?kd_l=!1:39==t?kd_r=!1:38==t||32==t?(kd_u=!1,setAcceleration(0)):16==t&&testing&&(shifty=!1)};var mba=null,mbi=null;(is_ios||is_android)&&(mba=document.createElement("a"),mbi=document.createElement("img"),mbi.border=0,mbi.draggable="false",mbi.className="nsi",mbi.width=1245,mbi.height=260,mbi.style.position="fixed",mbi.style.left="0px",mbi.style.bottom="0px",mbi.style.zIndex=70,mbi.src="/s/n2.jpg",mba.appendChild(mbi),document.body.appendChild(mba),is_ios?mba.href="https://itunes.apple.com/us/app/slither.io/id1091944550?ls=1&mt=8":is_android&&(mba.href=is_amazon?"http://www.amazon.com/Lowtech-Enterprises-slither-io/dp/B01E312TYQ/":"https://play.google.com/store/apps/details?id=air.com.hypah.io.slither")),resize(),o={f:function(t,e,s){"success"==e&&loadSos(t)}},getData("/i49526.txt",o);
